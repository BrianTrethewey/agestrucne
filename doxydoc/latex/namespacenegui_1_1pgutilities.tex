\hypertarget{namespacenegui_1_1pgutilities}{}\section{negui.\+pgutilities Namespace Reference}
\label{namespacenegui_1_1pgutilities}\index{negui.\+pgutilities@{negui.\+pgutilities}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespacenegui_1_1pgutilities_a20a66168135d35b6713e38b2503f6289}{do\+\_\+usage\+\_\+check} (ls\+\_\+this\+\_\+argv, ls\+\_\+required\+\_\+arg\+\_\+descriptions, ls\+\_\+optional\+\_\+arg\+\_\+descriptions=\mbox{[}$\,$\mbox{]}, b\+\_\+multi\+\_\+line\+\_\+msg=False, b\+\_\+unlimited\+\_\+final\+\_\+args=False, s\+\_\+note=None)
\item 
def {\bfseries get\+\_\+date\+\_\+time\+\_\+string\+\_\+dotted} ()\hypertarget{namespacenegui_1_1pgutilities_a926d8ee0bffed0d961dcfc3d169e05a4}{}\label{namespacenegui_1_1pgutilities_a926d8ee0bffed0d961dcfc3d169e05a4}

\item 
def {\bfseries is\+\_\+file\+\_\+and\+\_\+executable} (s\+\_\+path)\hypertarget{namespacenegui_1_1pgutilities_a8a347fe70cfaae23658adb58cd312e93}{}\label{namespacenegui_1_1pgutilities_a8a347fe70cfaae23658adb58cd312e93}

\item 
def {\bfseries confirm\+\_\+executable\+\_\+is\+\_\+in\+\_\+path} (s\+\_\+exectuable\+\_\+file\+\_\+name)\hypertarget{namespacenegui_1_1pgutilities_a8fe3f14ed21663af6196c0c53349c536}{}\label{namespacenegui_1_1pgutilities_a8fe3f14ed21663af6196c0c53349c536}

\item 
def {\bfseries manage\+\_\+process\+\_\+queue} (o\+\_\+queue\+\_\+with\+\_\+target\+\_\+calls, o\+\_\+queue\+\_\+to\+\_\+hold\+\_\+results=None)\hypertarget{namespacenegui_1_1pgutilities_a2096f66a8484e74902fb97c787c79345}{}\label{namespacenegui_1_1pgutilities_a2096f66a8484e74902fb97c787c79345}

\item 
def \hyperlink{namespacenegui_1_1pgutilities_a33737d6b655651fd586e77e269300eb4}{prep\+\_\+and\+\_\+call\+\_\+do\+\_\+pgopsimupop\+\_\+replicate} (s\+\_\+config\+\_\+file, s\+\_\+life\+\_\+table\+\_\+files, s\+\_\+param\+\_\+file, s\+\_\+output\+\_\+base\+\_\+name, s\+\_\+replicate\+\_\+number)
\begin{DoxyCompactList}\small\item\em end do\+\_\+sim\+\_\+replicate\+\_\+on\+\_\+separate\+\_\+os\+\_\+process \end{DoxyCompactList}\item 
def \hyperlink{namespacenegui_1_1pgutilities_af3612d8b0b5d45a71109ea49eec4f9b0}{do\+\_\+pgopsimupop\+\_\+replicate\+\_\+from\+\_\+files} (s\+\_\+configuration\+\_\+file, ls\+\_\+life\+\_\+table\+\_\+files, s\+\_\+param\+\_\+name\+\_\+file, s\+\_\+outfile\+\_\+basename, i\+\_\+replicate\+\_\+number)
\item 
def \hyperlink{namespacenegui_1_1pgutilities_aa37c7d125e4eaec2eeea639f53fa140d}{remove\+\_\+simulation\+\_\+replicate\+\_\+output\+\_\+files} (s\+\_\+basename)
\item 
def {\bfseries get\+\_\+class\+\_\+names\+\_\+immediate\+\_\+parent} (o\+\_\+object)\hypertarget{namespacenegui_1_1pgutilities_a6ab2e254a7954f6a3ad216cbbb18436c}{}\label{namespacenegui_1_1pgutilities_a6ab2e254a7954f6a3ad216cbbb18436c}

\item 
def {\bfseries get\+\_\+current\+\_\+working\+\_\+directory} ()\hypertarget{namespacenegui_1_1pgutilities_ada6bbd0893b0b9ecea89245329058e30}{}\label{namespacenegui_1_1pgutilities_ada6bbd0893b0b9ecea89245329058e30}

\item 
def {\bfseries get\+\_\+listdir} (s\+\_\+parent\+\_\+dir)\hypertarget{namespacenegui_1_1pgutilities_a46ba7adf1f3b80ee22ab635fa22ec8fa}{}\label{namespacenegui_1_1pgutilities_a46ba7adf1f3b80ee22ab635fa22ec8fa}

\item 
def {\bfseries does\+\_\+exist\+\_\+and\+\_\+is\+\_\+file} (s\+\_\+file)\hypertarget{namespacenegui_1_1pgutilities_a1be11f0c22a8f0b3cd2574ba02c2e04a}{}\label{namespacenegui_1_1pgutilities_a1be11f0c22a8f0b3cd2574ba02c2e04a}

\item 
def {\bfseries get\+\_\+list\+\_\+subdirectories} (s\+\_\+parent\+\_\+dir)\hypertarget{namespacenegui_1_1pgutilities_aa598e123d913111c3f191c0a725b57fd}{}\label{namespacenegui_1_1pgutilities_aa598e123d913111c3f191c0a725b57fd}

\item 
def {\bfseries get\+\_\+list\+\_\+file\+\_\+objects} (s\+\_\+parent\+\_\+dir)\hypertarget{namespacenegui_1_1pgutilities_ad045331ad9e74cc1d8fdc2a8c2b050af}{}\label{namespacenegui_1_1pgutilities_ad045331ad9e74cc1d8fdc2a8c2b050af}

\item 
def {\bfseries get\+\_\+list\+\_\+files\+\_\+and\+\_\+dirs\+\_\+from\+\_\+glob} (s\+\_\+glob)\hypertarget{namespacenegui_1_1pgutilities_aa5d355d2c26bf4992ce682449dfb93fc}{}\label{namespacenegui_1_1pgutilities_aa5d355d2c26bf4992ce682449dfb93fc}

\item 
def {\bfseries get\+\_\+basename\+\_\+from\+\_\+path} (s\+\_\+path)\hypertarget{namespacenegui_1_1pgutilities_abbecfce3431917f0ed764bc056b04fdc}{}\label{namespacenegui_1_1pgutilities_abbecfce3431917f0ed764bc056b04fdc}

\item 
def {\bfseries get\+\_\+dirname\+\_\+from\+\_\+path} (s\+\_\+path)\hypertarget{namespacenegui_1_1pgutilities_ae147f21f478f594d3e696d9198fa999b}{}\label{namespacenegui_1_1pgutilities_ae147f21f478f594d3e696d9198fa999b}

\item 
def {\bfseries remove\+\_\+files} (ls\+\_\+files)\hypertarget{namespacenegui_1_1pgutilities_ab276fa71e3e15636a51644dcb4f395ba}{}\label{namespacenegui_1_1pgutilities_ab276fa71e3e15636a51644dcb4f395ba}

\item 
def {\bfseries get\+\_\+separator\+\_\+character\+\_\+for\+\_\+current\+\_\+os} ()\hypertarget{namespacenegui_1_1pgutilities_a58912c5a49fed034b7899bae2763ea42}{}\label{namespacenegui_1_1pgutilities_a58912c5a49fed034b7899bae2763ea42}

\item 
def {\bfseries get\+\_\+platform} ()\hypertarget{namespacenegui_1_1pgutilities_a2086b2e2c5a53778e69925e7c9cb4ce5}{}\label{namespacenegui_1_1pgutilities_a2086b2e2c5a53778e69925e7c9cb4ce5}

\item 
def {\bfseries is\+\_\+windows\+\_\+platform} ()\hypertarget{namespacenegui_1_1pgutilities_afc489aeb6d08669a944cea475609c3ab}{}\label{namespacenegui_1_1pgutilities_afc489aeb6d08669a944cea475609c3ab}

\item 
def {\bfseries fix\+\_\+windows\+\_\+path} (s\+\_\+path)\hypertarget{namespacenegui_1_1pgutilities_a84406a87eec039d98e307a1e716b033d}{}\label{namespacenegui_1_1pgutilities_a84406a87eec039d98e307a1e716b033d}

\item 
def \hyperlink{namespacenegui_1_1pgutilities_a7dc2404b0e269d0b0848711c8271bb86}{do\+\_\+simulation\+\_\+reps\+\_\+in\+\_\+subprocesses} (o\+\_\+multiprocessing\+\_\+event, i\+\_\+input\+\_\+reps, i\+\_\+total\+\_\+processes\+\_\+for\+\_\+sims, s\+\_\+temp\+\_\+config\+\_\+file\+\_\+for\+\_\+running\+\_\+replicates, ls\+\_\+life\+\_\+table\+\_\+files, s\+\_\+param\+\_\+names\+\_\+file, s\+\_\+output\+\_\+basename)
\item 
def {\bfseries get\+\_\+cpu\+\_\+count} ()\hypertarget{namespacenegui_1_1pgutilities_a651d0e76f36897c5ca20e6d40d1a46a7}{}\label{namespacenegui_1_1pgutilities_a651d0e76f36897c5ca20e6d40d1a46a7}

\item 
def \hyperlink{namespacenegui_1_1pgutilities_aa839d4997d2bd2c15016c33cc7fce3b0}{dialog\+\_\+returns\+\_\+nothing} (v\+\_\+return\+\_\+value)
\item 
def \hyperlink{namespacenegui_1_1pgutilities_aed0f15b22462914445ffe1ec2a77cbc8}{convert\+\_\+genepop\+\_\+files\+\_\+string\+\_\+to\+\_\+list\+\_\+format} (s\+\_\+genepop\+\_\+files)
\item 
def \hyperlink{namespacenegui_1_1pgutilities_a177345979e44820072e37052d92bfd32}{run\+\_\+driveneestimator\+\_\+in\+\_\+new\+\_\+process} (o\+\_\+multiprocessing\+\_\+event, s\+\_\+genepop\+\_\+files, qs\+\_\+sample\+\_\+scheme\+\_\+args, f\+\_\+min\+\_\+allele\+\_\+freq, i\+\_\+replicates, qs\+\_\+loci\+\_\+sampling\+\_\+scheme\+\_\+args, i\+\_\+loci\+\_\+replicates, i\+\_\+num\+\_\+processes, s\+\_\+runmode, s\+\_\+outfile\+\_\+basename, s\+\_\+file\+\_\+delimiter=\char`\"{})
\item 
def {\bfseries show\+\_\+error\+\_\+in\+\_\+messagebox\+\_\+in\+\_\+new\+\_\+process} (o\+\_\+exception, s\+\_\+msg\+\_\+prefix=None)\hypertarget{namespacenegui_1_1pgutilities_a3f2675bc8eb3aae305ba8cc0c7df8d33}{}\label{namespacenegui_1_1pgutilities_a3f2675bc8eb3aae305ba8cc0c7df8d33}

\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
bool {\bfseries V\+E\+R\+B\+O\+SE} = False\hypertarget{namespacenegui_1_1pgutilities_a274572b1b2788c24df3e269bc2a3f1f7}{}\label{namespacenegui_1_1pgutilities_a274572b1b2788c24df3e269bc2a3f1f7}

\item 
string {\bfseries P\+R\+O\+C\+E\+S\+S\+\_\+\+Q\+U\+E\+U\+E\+\_\+\+S\+T\+O\+P\+\_\+\+S\+I\+GN} = \textquotesingle{}S\+T\+OP\textquotesingle{}\hypertarget{namespacenegui_1_1pgutilities_aed436e1fc2eb29963ea30b17e614fd04}{}\label{namespacenegui_1_1pgutilities_aed436e1fc2eb29963ea30b17e614fd04}

\item 
string {\bfseries S\+I\+M\+U\+L\+A\+T\+I\+O\+N\+\_\+\+O\+U\+T\+P\+U\+T\+\_\+\+F\+I\+L\+E\+\_\+\+R\+E\+P\+L\+I\+C\+A\+T\+E\+\_\+\+T\+AG} = \char`\"{}.r\char`\"{}\hypertarget{namespacenegui_1_1pgutilities_aeca2401751f6dc9cd4acbe9765271e20}{}\label{namespacenegui_1_1pgutilities_aeca2401751f6dc9cd4acbe9765271e20}

\item 
string {\bfseries D\+E\+L\+I\+M\+I\+T\+E\+R\+\_\+\+L\+I\+F\+E\+\_\+\+T\+A\+B\+L\+E\+\_\+\+F\+I\+L\+ES} = \char`\"{},\char`\"{}\hypertarget{namespacenegui_1_1pgutilities_ad2dc8f53cd27db093fc7f1227367d833}{}\label{namespacenegui_1_1pgutilities_ad2dc8f53cd27db093fc7f1227367d833}

\item 
string {\bfseries N\+E\+\_\+\+E\+S\+T\+I\+M\+A\+T\+I\+O\+N\+\_\+\+M\+A\+I\+N\+\_\+\+T\+A\+B\+L\+E\+\_\+\+F\+I\+L\+E\+\_\+\+E\+XT} = \char`\"{}ldne.\+tsv\char`\"{}\hypertarget{namespacenegui_1_1pgutilities_aa78d8e8004985b127644b8c985a2b551}{}\label{namespacenegui_1_1pgutilities_aa78d8e8004985b127644b8c985a2b551}

\item 
string {\bfseries N\+E\+\_\+\+E\+S\+T\+I\+M\+A\+T\+I\+O\+N\+\_\+\+S\+E\+C\+O\+N\+D\+A\+R\+Y\+\_\+\+O\+U\+T\+P\+U\+T\+\_\+\+F\+I\+L\+E\+\_\+\+E\+XT} = \char`\"{}ldne.\+msgs\char`\"{}\hypertarget{namespacenegui_1_1pgutilities_adfda5d480a10cf273a287871a5aba972}{}\label{namespacenegui_1_1pgutilities_adfda5d480a10cf273a287871a5aba972}

\item 
string {\bfseries S\+Y\+S\+\_\+\+L\+I\+N\+UX} = \char`\"{}linux\char`\"{}\hypertarget{namespacenegui_1_1pgutilities_aeccb8b0b17c7d891838cba42245af21f}{}\label{namespacenegui_1_1pgutilities_aeccb8b0b17c7d891838cba42245af21f}

\item 
string {\bfseries S\+Y\+S\+\_\+\+W\+I\+N\+D\+O\+WS} = \char`\"{}windows\char`\"{}\hypertarget{namespacenegui_1_1pgutilities_a1b63e58ac56fd9c130d038961d9d3f99}{}\label{namespacenegui_1_1pgutilities_a1b63e58ac56fd9c130d038961d9d3f99}

\item 
string {\bfseries S\+Y\+S\+\_\+\+M\+AC} = \char`\"{}mac\char`\"{}\hypertarget{namespacenegui_1_1pgutilities_a7013b038174112cd25916bc2b4e9736d}{}\label{namespacenegui_1_1pgutilities_a7013b038174112cd25916bc2b4e9736d}

\item 
{\bfseries s\+\_\+exec\+\_\+name} = sys.\+argv\mbox{[} 1 \mbox{]}\hypertarget{namespacenegui_1_1pgutilities_a25b185def2c6bb2698b1927b4a20a904}{}\label{namespacenegui_1_1pgutilities_a25b185def2c6bb2698b1927b4a20a904}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Description
Support defs for the pop gen interface programs.
\end{DoxyVerb}
 

\subsection{Function Documentation}
\index{negui\+::pgutilities@{negui\+::pgutilities}!convert\+\_\+genepop\+\_\+files\+\_\+string\+\_\+to\+\_\+list\+\_\+format@{convert\+\_\+genepop\+\_\+files\+\_\+string\+\_\+to\+\_\+list\+\_\+format}}
\index{convert\+\_\+genepop\+\_\+files\+\_\+string\+\_\+to\+\_\+list\+\_\+format@{convert\+\_\+genepop\+\_\+files\+\_\+string\+\_\+to\+\_\+list\+\_\+format}!negui\+::pgutilities@{negui\+::pgutilities}}
\subsubsection[{\texorpdfstring{convert\+\_\+genepop\+\_\+files\+\_\+string\+\_\+to\+\_\+list\+\_\+format(s\+\_\+genepop\+\_\+files)}{convert_genepop_files_string_to_list_format(s_genepop_files)}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgutilities.\+convert\+\_\+genepop\+\_\+files\+\_\+string\+\_\+to\+\_\+list\+\_\+format (
\begin{DoxyParamCaption}
\item[{}]{s\+\_\+genepop\+\_\+files}
\end{DoxyParamCaption}
)}\hypertarget{namespacenegui_1_1pgutilities_aed0f15b22462914445ffe1ec2a77cbc8}{}\label{namespacenegui_1_1pgutilities_aed0f15b22462914445ffe1ec2a77cbc8}
\begin{DoxyVerb}pgguineestimator object stores genepop files as a single string.
Each genepop file is delimited by a comma.  This def will
format the string to s_formatted_list, so that pgdriveneestimator.py can 
execute eval( s_formatted_list) and retrieve a python list of file names.
\end{DoxyVerb}
 

Definition at line 636 of file pgutilities.\+py.


\begin{DoxyCode}
636 \textcolor{keyword}{def }\hyperlink{namespacenegui_1_1pgutilities_aed0f15b22462914445ffe1ec2a77cbc8}{convert\_genepop\_files\_string\_to\_list\_format}( s\_genepop\_files
       ):  
637         \textcolor{stringliteral}{'''}
638 \textcolor{stringliteral}{        pgguineestimator object stores genepop files as a single string.}
639 \textcolor{stringliteral}{        Each genepop file is delimited by a comma.  This def will}
640 \textcolor{stringliteral}{        format the string to s\_formatted\_list, so that pgdriveneestimator.py can }
641 \textcolor{stringliteral}{        execute eval( s\_formatted\_list) and retrieve a python list of file names.}
642 \textcolor{stringliteral}{        '''}
643         ls\_files=s\_genepop\_files.split( \textcolor{stringliteral}{","} )
644 
645         ls\_quoted\_file\_names=[ \textcolor{stringliteral}{"'"} + s\_file + \textcolor{stringliteral}{"'"} \textcolor{keywordflow}{for} s\_file \textcolor{keywordflow}{in} ls\_files ]
646 
647         s\_quoted\_files=\textcolor{stringliteral}{","}.join( ls\_quoted\_file\_names )
648 
649         s\_genepop\_files\_formatted\_as\_python\_list= \textcolor{stringliteral}{"["} + s\_quoted\_files + \textcolor{stringliteral}{"]"}
650 
651         \textcolor{keywordflow}{return} s\_genepop\_files\_formatted\_as\_python\_list
652 \textcolor{comment}{#end convert\_genepop\_files\_string\_to\_list\_format}
653 
\end{DoxyCode}
\index{negui\+::pgutilities@{negui\+::pgutilities}!dialog\+\_\+returns\+\_\+nothing@{dialog\+\_\+returns\+\_\+nothing}}
\index{dialog\+\_\+returns\+\_\+nothing@{dialog\+\_\+returns\+\_\+nothing}!negui\+::pgutilities@{negui\+::pgutilities}}
\subsubsection[{\texorpdfstring{dialog\+\_\+returns\+\_\+nothing(v\+\_\+return\+\_\+value)}{dialog_returns_nothing(v_return_value)}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgutilities.\+dialog\+\_\+returns\+\_\+nothing (
\begin{DoxyParamCaption}
\item[{}]{v\+\_\+return\+\_\+value}
\end{DoxyParamCaption}
)}\hypertarget{namespacenegui_1_1pgutilities_aa839d4997d2bd2c15016c33cc7fce3b0}{}\label{namespacenegui_1_1pgutilities_aa839d4997d2bd2c15016c33cc7fce3b0}
\begin{DoxyVerb}To evaluate return values from askopenfilenames,
askdirectory, askopenfilename, dialog windows.
Note that unlike askopenfile (singular),
an empty tuple is returned by askdirectory when
the diag is cancelled on the first instance it
is invoked, and an empty string thereafter.  
askopenfilenames returns an empty tuple on all cancels.
\end{DoxyVerb}
 

Definition at line 604 of file pgutilities.\+py.


\begin{DoxyCode}
604 \textcolor{keyword}{def }\hyperlink{namespacenegui_1_1pgutilities_aa839d4997d2bd2c15016c33cc7fce3b0}{dialog\_returns\_nothing}( v\_return\_value ):
605 
606     \textcolor{stringliteral}{'''}
607 \textcolor{stringliteral}{    To evaluate return values from askopenfilenames,}
608 \textcolor{stringliteral}{    askdirectory, askopenfilename, dialog windows.}
609 \textcolor{stringliteral}{    Note that unlike askopenfile (singular),}
610 \textcolor{stringliteral}{    an empty tuple is returned by askdirectory when}
611 \textcolor{stringliteral}{    the diag is cancelled on the first instance it}
612 \textcolor{stringliteral}{    is invoked, and an empty string thereafter.  }
613 \textcolor{stringliteral}{    askopenfilenames returns an empty tuple on all cancels.}
614 \textcolor{stringliteral}{    '''} 
615 
616     b\_is\_nothing=\textcolor{keyword}{False}
617 
618     o\_return\_type=type( v\_return\_value )
619 
620     \textcolor{keywordflow}{if} o\_return\_type == tuple:
621         b\_is\_nothing = ( len( v\_return\_value ) == 0 )
622     \textcolor{keywordflow}{elif} o\_return\_type == str:
623         b\_is\_nothing = ( v\_return\_value == \textcolor{stringliteral}{""} )
624     \textcolor{keywordflow}{elif} o\_return\_type == unicode:
625         b\_is\_nothing == \textcolor{stringliteral}{""}
626     \textcolor{keywordflow}{else}:
627         s\_msg = \textcolor{stringliteral}{"In pgutilities, def dialog\_returns\_nothing(), "} \(\backslash\)
628                 + \textcolor{stringliteral}{"Unknown return value type: "} \(\backslash\)
629                 + str( o\_return\_type ) + \textcolor{stringliteral}{"."}
630         \textcolor{keywordflow}{raise} Exception( s\_msg )
631     \textcolor{comment}{#end if return is a tuple, else string, else error}
632 
633     \textcolor{keywordflow}{return} b\_is\_nothing 
634 \textcolor{comment}{#end dialog\_returns\_nothing}
635 
\end{DoxyCode}
\index{negui\+::pgutilities@{negui\+::pgutilities}!do\+\_\+pgopsimupop\+\_\+replicate\+\_\+from\+\_\+files@{do\+\_\+pgopsimupop\+\_\+replicate\+\_\+from\+\_\+files}}
\index{do\+\_\+pgopsimupop\+\_\+replicate\+\_\+from\+\_\+files@{do\+\_\+pgopsimupop\+\_\+replicate\+\_\+from\+\_\+files}!negui\+::pgutilities@{negui\+::pgutilities}}
\subsubsection[{\texorpdfstring{do\+\_\+pgopsimupop\+\_\+replicate\+\_\+from\+\_\+files(s\+\_\+configuration\+\_\+file, ls\+\_\+life\+\_\+table\+\_\+files, s\+\_\+param\+\_\+name\+\_\+file, s\+\_\+outfile\+\_\+basename, i\+\_\+replicate\+\_\+number)}{do_pgopsimupop_replicate_from_files(s_configuration_file, ls_life_table_files, s_param_name_file, s_outfile_basename, i_replicate_number)}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgutilities.\+do\+\_\+pgopsimupop\+\_\+replicate\+\_\+from\+\_\+files (
\begin{DoxyParamCaption}
\item[{}]{s\+\_\+configuration\+\_\+file, }
\item[{}]{ls\+\_\+life\+\_\+table\+\_\+files, }
\item[{}]{s\+\_\+param\+\_\+name\+\_\+file, }
\item[{}]{s\+\_\+outfile\+\_\+basename, }
\item[{}]{i\+\_\+replicate\+\_\+number}
\end{DoxyParamCaption}
)}\hypertarget{namespacenegui_1_1pgutilities_af3612d8b0b5d45a71109ea49eec4f9b0}{}\label{namespacenegui_1_1pgutilities_af3612d8b0b5d45a71109ea49eec4f9b0}
\begin{DoxyVerb}necessitated by fact that python2 (and 3?) was not able to pickle 
a class-instance def to be used to run replicates of the pgopsimupop
doOp().  Python also failed to pickle SWIG-based code used in Simupop.
Thus the better design, in which  multiprocessing Pools would stay  encapsulated 
inside a class object seem problematic, though may be implement-able using 
reg_copy -- but I'm not confident in state of regcopy of imported simuPop code,
and so  I think is the safer solution, though it
does create a depandancy of the pgguisimupop object on this outside def.  

Note that this def runs a simupop operation using all the param values as
given in the config file arg, except for the "reps" attribute, with is reset to 1,
whatever the value in the configuration file.

Tue Jul 26 22:01:07 MDT 2016
updated to be called by a driver that creates a new OS process, then calls this def to do the replicate.  No longer
uses the dv_input_parm_values_by_attribute, but instead relies on reading a complete and up-to-date (i.e. all values
as changed or edited on the gui interface) configuration files (that includes the "life table" params).
\end{DoxyVerb}
 

Definition at line 215 of file pgutilities.\+py.


\begin{DoxyCode}
215                                                 i\_replicate\_number ):
216     \textcolor{stringliteral}{'''}
217 \textcolor{stringliteral}{    necessitated by fact that python2 (and 3?) was not able to pickle }
218 \textcolor{stringliteral}{    a class-instance def to be used to run replicates of the pgopsimupop}
219 \textcolor{stringliteral}{    doOp().  Python also failed to pickle SWIG-based code used in Simupop.}
220 \textcolor{stringliteral}{    Thus the better design, in which  multiprocessing Pools would stay  encapsulated }
221 \textcolor{stringliteral}{    inside a class object seem problematic, though may be implement-able using }
222 \textcolor{stringliteral}{    reg\_copy -- but I'm not confident in state of regcopy of imported simuPop code,}
223 \textcolor{stringliteral}{    and so  I think is the safer solution, though it}
224 \textcolor{stringliteral}{    does create a depandancy of the pgguisimupop object on this outside def.  }
225 \textcolor{stringliteral}{}
226 \textcolor{stringliteral}{    Note that this def runs a simupop operation using all the param values as}
227 \textcolor{stringliteral}{    given in the config file arg, except for the "reps" attribute, with is reset to 1,}
228 \textcolor{stringliteral}{    whatever the value in the configuration file.}
229 \textcolor{stringliteral}{}
230 \textcolor{stringliteral}{    Tue Jul 26 22:01:07 MDT 2016}
231 \textcolor{stringliteral}{    updated to be called by a driver that creates a new OS process, then calls this def to do the
       replicate.  No longer}
232 \textcolor{stringliteral}{    uses the dv\_input\_parm\_values\_by\_attribute, but instead relies on reading a complete and up-to-date
       (i.e. all values}
233 \textcolor{stringliteral}{    as changed or edited on the gui interface) configuration files (that includes the "life table" params).}
234 \textcolor{stringliteral}{    '''}
235 
236     s\_tag\_out=\textcolor{stringliteral}{""}
237 
238     NUMBER\_FIRST\_REPLICATE=1
239 
240     \textcolor{stringliteral}{'''}
241 \textcolor{stringliteral}{    As of 2016\_08\_23 the *sim, *gen, *db files}
242 \textcolor{stringliteral}{    are not used, and clutter up the output directories,}
243 \textcolor{stringliteral}{    per other users comments}
244 \textcolor{stringliteral}{    '''}
245 
246     \textcolor{comment}{#whether or not to remove the *sim *gen *db}
247     \textcolor{comment}{#files (original output from Tiago's code ), }
248     \textcolor{comment}{#which leaves only a *conf and *genepop}
249     \textcolor{comment}{#files as output}
250 
251     REMOVE\_NON\_GENEPOP\_SIM\_OUTPUT\_FILES=\textcolor{keyword}{True}
252 
253     \textcolor{keywordflow}{if} i\_replicate\_number \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
254         s\_tag\_out=SIMULATION\_OUTPUT\_FILE\_REPLICATE\_TAG + str( i\_replicate\_number )
255 
256     \textcolor{comment}{#end if rep number is not none}
257 
258     o\_resources=pgrec.PGSimuPopResources( ls\_life\_table\_files )
259     o\_paramset=pgpar.PGParamSet( s\_param\_name\_file )
260     o\_input=pgin.PGInputSimuPop( s\_configuration\_file, o\_resources, o\_paramset ) 
261     o\_input.makeInputConfig()
262 
263     b\_write\_conf\_file=\textcolor{keyword}{False}
264 
265     \textcolor{comment}{#we only write the configuraton file if the replicate number is 1:}
266     \textcolor{keywordflow}{if} i\_replicate\_number == NUMBER\_FIRST\_REPLICATE:
267         b\_write\_conf\_file=\textcolor{keyword}{True}
268     \textcolor{comment}{#end if first replicate number}
269 
270     \textcolor{comment}{#reset reps to 1}
271     \textcolor{comment}{#as we are executing only one}
272     \textcolor{comment}{#replicate.  We assume this def}
273     \textcolor{comment}{#is being called as one of a number}
274     \textcolor{comment}{#of parallel process calls for}
275     \textcolor{comment}{#a set of replicates, the total }
276     \textcolor{comment}{#known to the caller:}
277     o\_input.reps=1
278 
279     o\_output=pgout.PGOutputSimuPop( s\_outfile\_basename )
280 
281     o\_new\_pgopsimupop\_instance=pgsim.PGOpSimuPop( o\_input,
282             o\_output, 
283             b\_remove\_db\_gen\_sim\_files=REMOVE\_NON\_GENEPOP\_SIM\_OUTPUT\_FILES,
284             b\_write\_input\_as\_config\_file=b\_write\_conf\_file )
285 
286     o\_new\_pgopsimupop\_instance.prepareOp( s\_tag\_out  )
287 
288     o\_new\_pgopsimupop\_instance.doOp()
289 
290     \textcolor{keywordflow}{return}
291 \textcolor{comment}{#end do\_pgopsimupop\_replicate\_from\_files}
292 
\end{DoxyCode}
\index{negui\+::pgutilities@{negui\+::pgutilities}!do\+\_\+simulation\+\_\+reps\+\_\+in\+\_\+subprocesses@{do\+\_\+simulation\+\_\+reps\+\_\+in\+\_\+subprocesses}}
\index{do\+\_\+simulation\+\_\+reps\+\_\+in\+\_\+subprocesses@{do\+\_\+simulation\+\_\+reps\+\_\+in\+\_\+subprocesses}!negui\+::pgutilities@{negui\+::pgutilities}}
\subsubsection[{\texorpdfstring{do\+\_\+simulation\+\_\+reps\+\_\+in\+\_\+subprocesses(o\+\_\+multiprocessing\+\_\+event, i\+\_\+input\+\_\+reps, i\+\_\+total\+\_\+processes\+\_\+for\+\_\+sims, s\+\_\+temp\+\_\+config\+\_\+file\+\_\+for\+\_\+running\+\_\+replicates, ls\+\_\+life\+\_\+table\+\_\+files, s\+\_\+param\+\_\+names\+\_\+file, s\+\_\+output\+\_\+basename)}{do_simulation_reps_in_subprocesses(o_multiprocessing_event, i_input_reps, i_total_processes_for_sims, s_temp_config_file_for_running_replicates, ls_life_table_files, s_param_names_file, s_output_basename)}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgutilities.\+do\+\_\+simulation\+\_\+reps\+\_\+in\+\_\+subprocesses (
\begin{DoxyParamCaption}
\item[{}]{o\+\_\+multiprocessing\+\_\+event, }
\item[{}]{i\+\_\+input\+\_\+reps, }
\item[{}]{i\+\_\+total\+\_\+processes\+\_\+for\+\_\+sims, }
\item[{}]{s\+\_\+temp\+\_\+config\+\_\+file\+\_\+for\+\_\+running\+\_\+replicates, }
\item[{}]{ls\+\_\+life\+\_\+table\+\_\+files, }
\item[{}]{s\+\_\+param\+\_\+names\+\_\+file, }
\item[{}]{s\+\_\+output\+\_\+basename}
\end{DoxyParamCaption}
)}\hypertarget{namespacenegui_1_1pgutilities_a7dc2404b0e269d0b0848711c8271bb86}{}\label{namespacenegui_1_1pgutilities_a7dc2404b0e269d0b0848711c8271bb86}
\begin{DoxyVerb}Failed to get independant initialization of population per-replicate
when i used python's multiprocessing.process objects as hosts for 
running replicates in parallel.  Solution as of now, 
Sat Jul 30 22:38:42 MDT 2016, is to use OS processes via python's 
subprocess module, creating them in this def, which gets its
requisite info needed for the sim from the pgguisimupop instance
that calls this def (this def is called by the GUI interface instance
in a new python.multiprocessing.process instance, in order not to block the gui).

Note that this def was originally inside the pgguisimupop instance that calls it,
but on windows there was a pickling error not seen on linux or Mac.  Moving this
target def for the python.multiprocessing.process outside the pgguisimupop instance
seems to have solved the problem on windows (win 10).

This def manages the replices via creating subprocesses, and 
calling pgutilities.prep_and_call_do_pgopsimupop_replicate.\end{DoxyVerb}
 

Definition at line 431 of file pgutilities.\+py.


\begin{DoxyCode}
431             s\_output\_basename ):
432 
433     \textcolor{stringliteral}{'''}
434 \textcolor{stringliteral}{    Failed to get independant initialization of population per-replicate}
435 \textcolor{stringliteral}{    when i used python's multiprocessing.process objects as hosts for }
436 \textcolor{stringliteral}{    running replicates in parallel.  Solution as of now, }
437 \textcolor{stringliteral}{    Sat Jul 30 22:38:42 MDT 2016, is to use OS processes via python's }
438 \textcolor{stringliteral}{    subprocess module, creating them in this def, which gets its}
439 \textcolor{stringliteral}{    requisite info needed for the sim from the pgguisimupop instance}
440 \textcolor{stringliteral}{    that calls this def (this def is called by the GUI interface instance}
441 \textcolor{stringliteral}{    in a new python.multiprocessing.process instance, in order not to block the gui).}
442 \textcolor{stringliteral}{}
443 \textcolor{stringliteral}{    Note that this def was originally inside the pgguisimupop instance that calls it,}
444 \textcolor{stringliteral}{    but on windows there was a pickling error not seen on linux or Mac.  Moving this}
445 \textcolor{stringliteral}{    target def for the python.multiprocessing.process outside the pgguisimupop instance}
446 \textcolor{stringliteral}{    seems to have solved the problem on windows (win 10).}
447 \textcolor{stringliteral}{}
448 \textcolor{stringliteral}{    This def manages the replices via creating subprocesses, and }
449 \textcolor{stringliteral}{    calling pgutilities.prep\_and\_call\_do\_pgopsimupop\_replicate.}
450 \textcolor{stringliteral}{}
451 \textcolor{stringliteral}{    '''} 
452 
453     \textcolor{stringliteral}{''' }
454 \textcolor{stringliteral}{    Running this inside a try block allows us to notify GUI}
455 \textcolor{stringliteral}{    users of exceptions propogated from anywere inside the }
456 \textcolor{stringliteral}{    simulation setup and execution code. When we catch exceptions }
457 \textcolor{stringliteral}{    below, we send an error message to a gui message box, then}
458 \textcolor{stringliteral}{    re-raise the exception. }
459 \textcolor{stringliteral}{    '''}
460     \textcolor{keywordflow}{try}:
461         s\_life\_tables\_stringified=\textcolor{stringliteral}{","}.join( ls\_life\_table\_files )
462 
463         \textcolor{comment}{#if we're on windows, out strings of file}
464         \textcolor{comment}{#paths may be a mangled mix of unix and }
465         \textcolor{comment}{#windows separators -- with errors resulting}
466         \textcolor{comment}{#downstream.  So we standardize:}
467         \textcolor{keywordflow}{if} is\_windows\_platform():
468             s\_life\_tables\_stringified= \(\backslash\)
469                 fix\_windows\_path( s\_life\_tables\_stringified )
470             s\_param\_names\_file= \(\backslash\)
471                 fix\_windows\_path( s\_param\_names\_file )              
472             s\_output\_basename= \(\backslash\)
473                 fix\_windows\_path( s\_output\_basename )   
474         \textcolor{comment}{#end if windows, fix file path strings}
475 
476         i\_total\_replicates\_requested=i\_input\_reps
477 
478         i\_max\_processes\_to\_use=i\_total\_processes\_for\_sims
479 
480 
481         \textcolor{comment}{#we use a python command for a -c arg in the Popen command (see below)}
482         \textcolor{comment}{#and these will be the same args for each replicate (we add the rep-number}
483         \textcolor{comment}{#arg below).  We stringify so that they can be Popen command args.  Some}
484         \textcolor{comment}{#are de-stringified by the pgutilities def before sending to pgop-creator}
485         seq\_first\_four\_args\_to\_sim\_call=( s\_temp\_config\_file\_for\_running\_replicates,
486                                         s\_life\_tables\_stringified,
487                                         s\_param\_names\_file,
488                                         s\_output\_basename )
489         
490         i\_total\_replicates\_started=0
491 
492         o\_subprocess\_group=IndependantSubprocessGroup()
493 
494         \textcolor{keywordflow}{while} i\_total\_replicates\_started < i\_total\_replicates\_requested:
495             \textcolor{comment}{#see if we need to cancel:  }
496             \textcolor{keywordflow}{if} o\_multiprocessing\_event.is\_set():
497 
498                 \textcolor{keywordflow}{if} VERBOSE:
499                     \textcolor{keywordflow}{print} ( \textcolor{stringliteral}{"received event in setup loop"} )
500                 \textcolor{comment}{#end if VERBOSE}
501 
502                 o\_subprocess\_group.terminateAllSubprocesses()
503                 
504                 \hyperlink{namespacenegui_1_1pgutilities_aa37c7d125e4eaec2eeea639f53fa140d}{remove\_simulation\_replicate\_output\_files}( 
      s\_output\_basename )
505 
506                 \textcolor{keywordflow}{break}
507 
508             \textcolor{keywordflow}{else}:
509 
510                 i\_number\_subprocesses\_alive=o\_subprocess\_group.getTotalAlive()
511 
512                 i\_number\_subprocesses\_available= \(\backslash\)
513                         i\_max\_processes\_to\_use-i\_number\_subprocesses\_alive
514 
515                 i\_number\_replicates\_to\_go=i\_total\_replicates\_requested - i\_total\_replicates\_started
516 
517                 i\_number\_subprocesses\_to\_start=i\_number\_subprocesses\_available
518 
519                 \textcolor{comment}{#reduce the number to start if we have fewer reps to go than avail procs:}
520                 \textcolor{keywordflow}{if} i\_number\_subprocesses\_available > i\_number\_replicates\_to\_go:
521                         i\_number\_subprocesses\_to\_start = i\_number\_replicates\_to\_go
522                 \textcolor{comment}{#end if fewer needed than available}
523 
524                 \textcolor{keywordflow}{for} idx \textcolor{keywordflow}{in} range( i\_number\_subprocesses\_to\_start ):
525 
526                     i\_total\_replicates\_started += 1
527                     
528                     \textcolor{comment}{#In the Popen call, rather than rely on a driver python script }
529                     \textcolor{comment}{#that would need to be in PATH, we'll simply}
530                     \textcolor{comment}{#invoke python with a "-c" argument that imports the }
531                     \textcolor{comment}{#pgutilities module and executes the correct def:}
532             
533                     \textcolor{comment}{#complete the set of args used in the command by adding the}
534                     \textcolor{comment}{#replicate number (recall need comma in sequence with single item,}
535                     \textcolor{comment}{#to delineate sequence versus simple expression):}
536                     seq\_complete\_arg\_set=seq\_first\_four\_args\_to\_sim\_call + ( str( 
      i\_total\_replicates\_started ), )
537 
538                     \textcolor{stringliteral}{'''}
539 \textcolor{stringliteral}{                    in case the negui mods are not in the default python }
540 \textcolor{stringliteral}{                    install dirs, then we need to add them to the sys.paths in}
541 \textcolor{stringliteral}{                    any  spawned invocation of python exe -- seems that }
542 \textcolor{stringliteral}{                    the PYTHONPATH env var known to this parent process }
543 \textcolor{stringliteral}{                    is unknown to the "python" invocation via Popen.  }
544 \textcolor{stringliteral}{                    We can get for and then add to our new python invocation}
545 \textcolor{stringliteral}{                    the path to all negui modules by getting the}
546 \textcolor{stringliteral}{                    path to this module:}
547 \textcolor{stringliteral}{                    '''}
548                     s\_curr\_mod\_path = os.path.abspath(\_\_file\_\_)
549 
550                     \textcolor{comment}{#path only (stripped off "/utilities.py" )}
551                     \textcolor{comment}{#-- gives path to all negui mods:}
552                     s\_mod\_dir=os.path.dirname( s\_curr\_mod\_path )
553 
554                     \textcolor{comment}{#need to fix the path if we're on windows:}
555                     \textcolor{keywordflow}{if} is\_windows\_platform():
556                         s\_mod\_dir=fix\_windows\_path( s\_mod\_dir )
557                     \textcolor{comment}{#end if windows, fix path}
558                     
559                     s\_path\_append\_statements=\textcolor{stringliteral}{"import sys; sys.path.append( \(\backslash\)""} \(\backslash\)
560                             + s\_mod\_dir + \textcolor{stringliteral}{"\(\backslash\)" );"}
561 
562                     s\_python\_command=s\_path\_append\_statements + \textcolor{stringliteral}{"import pgutilities;"} \(\backslash\)
563                                         \textcolor{stringliteral}{"pgutilities.prep\_and\_call\_do\_pgopsimupop\_replicate"} \(\backslash\)
564                                         + \textcolor{stringliteral}{"( \(\backslash\)"%s\(\backslash\)", \(\backslash\)"%s\(\backslash\)", \(\backslash\)"%s\(\backslash\)", \(\backslash\)"%s\(\backslash\)", \(\backslash\)"%s\(\backslash\)" )"} %  
      seq\_complete\_arg\_set
565 
566                     o\_new\_subprocess=subprocess.Popen( [ \textcolor{stringliteral}{"python"}, \textcolor{stringliteral}{"-c"}, s\_python\_command ] )
567                     o\_subprocess\_group.addSubprocess( o\_new\_subprocess ) 
568                 \textcolor{comment}{#end for each idx of new procs}
569             \textcolor{comment}{#end if event is set else not}
570         \textcolor{comment}{#end while preplicates need to be started}
571 
572         \textcolor{comment}{#we don't want to return untill all processes are done.}
573         \textcolor{comment}{#meantime test for cancel-request}
574         i\_total\_still\_alive\_after\_creating\_all=o\_subprocess\_group.getTotalAlive()
575 
576         \textcolor{keywordflow}{while} i\_total\_still\_alive\_after\_creating\_all > 0:
577             \textcolor{keywordflow}{if} o\_multiprocessing\_event.is\_set():
578 
579                 \textcolor{keywordflow}{if} VERBOSE:
580                     print( \textcolor{stringliteral}{"received event in final loop"} )
581                 \textcolor{comment}{#end if verbose}
582 
583                 o\_subprocess\_group.terminateAllSubprocesses()
584                 \hyperlink{namespacenegui_1_1pgutilities_aa37c7d125e4eaec2eeea639f53fa140d}{remove\_simulation\_replicate\_output\_files}( 
      s\_output\_basename )
585             \textcolor{comment}{#end if we are to cancel}
586             i\_total\_still\_alive\_after\_creating\_all=o\_subprocess\_group.getTotalAlive()
587         \textcolor{comment}{#end while}
588 
589     \textcolor{keywordflow}{except} Exception \textcolor{keyword}{as} oex:
590         show\_error\_in\_messagebox\_in\_new\_process( oex, 
591                 s\_msg\_prefix = \textcolor{stringliteral}{"Error caught by pgutilities, "}
592                                 + \textcolor{stringliteral}{"def \_\_do\_simulation\_reps\_in\_subprocesses."} )
593         \textcolor{keywordflow}{raise} oex
594     \textcolor{comment}{#end try...except...}
595 
596 
597     \textcolor{keywordflow}{return}
598 \textcolor{comment}{#end \_\_do\_simulation\_reps\_in\_subprocesses}
599 
\end{DoxyCode}
\index{negui\+::pgutilities@{negui\+::pgutilities}!do\+\_\+usage\+\_\+check@{do\+\_\+usage\+\_\+check}}
\index{do\+\_\+usage\+\_\+check@{do\+\_\+usage\+\_\+check}!negui\+::pgutilities@{negui\+::pgutilities}}
\subsubsection[{\texorpdfstring{do\+\_\+usage\+\_\+check(ls\+\_\+this\+\_\+argv, ls\+\_\+required\+\_\+arg\+\_\+descriptions, ls\+\_\+optional\+\_\+arg\+\_\+descriptions=[], b\+\_\+multi\+\_\+line\+\_\+msg=\+False, b\+\_\+unlimited\+\_\+final\+\_\+args=\+False, s\+\_\+note=\+None)}{do_usage_check(ls_this_argv, ls_required_arg_descriptions, ls_optional_arg_descriptions=[], b_multi_line_msg=False, b_unlimited_final_args=False, s_note=None)}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgutilities.\+do\+\_\+usage\+\_\+check (
\begin{DoxyParamCaption}
\item[{}]{ls\+\_\+this\+\_\+argv, }
\item[{}]{ls\+\_\+required\+\_\+arg\+\_\+descriptions, }
\item[{}]{ls\+\_\+optional\+\_\+arg\+\_\+descriptions = {\ttfamily \mbox{[}\mbox{]}}, }
\item[{}]{b\+\_\+multi\+\_\+line\+\_\+msg = {\ttfamily False}, }
\item[{}]{b\+\_\+unlimited\+\_\+final\+\_\+args = {\ttfamily False}, }
\item[{}]{s\+\_\+note = {\ttfamily None}}
\end{DoxyParamCaption}
)}\hypertarget{namespacenegui_1_1pgutilities_a20a66168135d35b6713e38b2503f6289}{}\label{namespacenegui_1_1pgutilities_a20a66168135d35b6713e38b2503f6289}
\begin{DoxyVerb}arg 1 expects sys.argv, or a copy
arg 2 expects a list strings, in order, required args
arg 3 expects a list of strings, in order, any optional args
\end{DoxyVerb}
 

Definition at line 55 of file pgutilities.\+py.


\begin{DoxyCode}
55             s\_note=\textcolor{keywordtype}{None}):
56     \textcolor{stringliteral}{'''}
57 \textcolor{stringliteral}{    arg 1 expects sys.argv, or a copy}
58 \textcolor{stringliteral}{    arg 2 expects a list strings, in order, required args}
59 \textcolor{stringliteral}{    arg 3 expects a list of strings, in order, any optional args}
60 \textcolor{stringliteral}{    '''}
61     i\_num\_args\_required = len( ls\_required\_arg\_descriptions )
62     i\_num\_args\_optional = len( ls\_optional\_arg\_descriptions )
63     i\_max\_poss\_num\_args = i\_num\_args\_required + i\_num\_args\_optional 
64     i\_num\_args\_passed = len( ls\_this\_argv ) - 1  
65     s\_usage\_string = \textcolor{stringliteral}{""}
66     s\_arg\_delimit=\textcolor{stringliteral}{""}
67     \textcolor{keywordflow}{if} b\_multi\_line\_msg == \textcolor{keyword}{True}:
68         s\_arg\_delimit=\textcolor{stringliteral}{"\(\backslash\)n"}
69     \textcolor{comment}{#end if we put each arg descript on a }
70     \textcolor{comment}{#separate line of output}
71 
72     \textcolor{keywordflow}{if} i\_num\_args\_passed <  i\_num\_args\_required  \(\backslash\)
73             \textcolor{keywordflow}{or} (i\_num\_args\_passed > i\_max\_poss\_num\_args \textcolor{keywordflow}{and} b\_unlimited\_final\_args == \textcolor{keyword}{False} ): 
74     
75         s\_scriptname = os.path.basename( ls\_this\_argv[ 0 ] )    
76         s\_usage\_string = \textcolor{stringliteral}{"usage: "} + s\_scriptname 
77 
78         \textcolor{keywordflow}{if} b\_multi\_line\_msg:
79             s\_usage\_string=\textcolor{stringliteral}{"usage: "} + s\_scriptname \(\backslash\)
80                     + \textcolor{stringliteral}{"\(\backslash\)nargs:\(\backslash\)n"}
81         \textcolor{keywordflow}{else}:
82             s\_usage\_string = \textcolor{stringliteral}{"usage: "} + s\_scriptname 
83         \textcolor{comment}{#end if multi line else not}
84 
85         \textcolor{keywordflow}{for} s\_arg \textcolor{keywordflow}{in} ls\_required\_arg\_descriptions:
86 
87             s\_usage\_string += \textcolor{stringliteral}{" <"} \(\backslash\)
88                 + s\_arg + \textcolor{stringliteral}{">"} \(\backslash\)
89                 + s\_arg\_delimit
90         \textcolor{comment}{#end for each requried arg}
91 
92         \textcolor{keywordflow}{for} s\_arg \textcolor{keywordflow}{in} ls\_optional\_arg\_descriptions:
93 
94             s\_usage\_string += \textcolor{stringliteral}{" <(optional) "} \(\backslash\)
95                 + s\_arg + \textcolor{stringliteral}{">"} \(\backslash\)
96                 + s\_arg\_delimit
97         \textcolor{comment}{#end for each required arg}
98 
99     \textcolor{comment}{#end if number of args is out of range}
100 
101     \textcolor{keywordflow}{if} s\_usage\_string != \textcolor{stringliteral}{""} \textcolor{keywordflow}{and} s\_note \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
102         s\_usage\_string=s\_usage\_string + \textcolor{stringliteral}{"\(\backslash\)n"} + s\_note
103     \textcolor{comment}{#end if note }
104 
105     \textcolor{keywordflow}{return}  s\_usage\_string 
106 \textcolor{comment}{#def do\_usage\_check}
107 
\end{DoxyCode}
\index{negui\+::pgutilities@{negui\+::pgutilities}!prep\+\_\+and\+\_\+call\+\_\+do\+\_\+pgopsimupop\+\_\+replicate@{prep\+\_\+and\+\_\+call\+\_\+do\+\_\+pgopsimupop\+\_\+replicate}}
\index{prep\+\_\+and\+\_\+call\+\_\+do\+\_\+pgopsimupop\+\_\+replicate@{prep\+\_\+and\+\_\+call\+\_\+do\+\_\+pgopsimupop\+\_\+replicate}!negui\+::pgutilities@{negui\+::pgutilities}}
\subsubsection[{\texorpdfstring{prep\+\_\+and\+\_\+call\+\_\+do\+\_\+pgopsimupop\+\_\+replicate(s\+\_\+config\+\_\+file, s\+\_\+life\+\_\+table\+\_\+files, s\+\_\+param\+\_\+file, s\+\_\+output\+\_\+base\+\_\+name, s\+\_\+replicate\+\_\+number)}{prep_and_call_do_pgopsimupop_replicate(s_config_file, s_life_table_files, s_param_file, s_output_base_name, s_replicate_number)}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgutilities.\+prep\+\_\+and\+\_\+call\+\_\+do\+\_\+pgopsimupop\+\_\+replicate (
\begin{DoxyParamCaption}
\item[{}]{s\+\_\+config\+\_\+file, }
\item[{}]{s\+\_\+life\+\_\+table\+\_\+files, }
\item[{}]{s\+\_\+param\+\_\+file, }
\item[{}]{s\+\_\+output\+\_\+base\+\_\+name, }
\item[{}]{s\+\_\+replicate\+\_\+number}
\end{DoxyParamCaption}
)}\hypertarget{namespacenegui_1_1pgutilities_a33737d6b655651fd586e77e269300eb4}{}\label{namespacenegui_1_1pgutilities_a33737d6b655651fd586e77e269300eb4}


end do\+\_\+sim\+\_\+replicate\+\_\+on\+\_\+separate\+\_\+os\+\_\+process 

\begin{DoxyVerb}This def to be invoked in a subprocess.Popen command, as
instantiated in a PGGuiSimuPop instance in do_operation.

This def simply prepares the args for the call to def
do_pgopsimupop_replicate_from_files (below).
\end{DoxyVerb}
 

Definition at line 189 of file pgutilities.\+py.


\begin{DoxyCode}
189                         s\_replicate\_number ):
190     \textcolor{stringliteral}{''' }
191 \textcolor{stringliteral}{    This def to be invoked in a subprocess.Popen command, as}
192 \textcolor{stringliteral}{    instantiated in a PGGuiSimuPop instance in do\_operation.}
193 \textcolor{stringliteral}{}
194 \textcolor{stringliteral}{    This def simply prepares the args for the call to def}
195 \textcolor{stringliteral}{    do\_pgopsimupop\_replicate\_from\_files (below).}
196 \textcolor{stringliteral}{    '''}
197 
198     \textcolor{comment}{#de-stringify args for call to def below:}
199     ls\_life\_table\_files = s\_life\_table\_files.split( DELIMITER\_LIFE\_TABLE\_FILES )
200     i\_replicate\_number=int( s\_replicate\_number )
201 
202     \hyperlink{namespacenegui_1_1pgutilities_af3612d8b0b5d45a71109ea49eec4f9b0}{do\_pgopsimupop\_replicate\_from\_files}( s\_config\_file,
203                         ls\_life\_table\_files,
204                         s\_param\_file,
205                         s\_output\_base\_name,
206                         i\_replicate\_number )
207 
208     \textcolor{keywordflow}{return}
209 \textcolor{comment}{#end prep\_and\_call\_do\_pgopsimupop\_replicate}
210 
\end{DoxyCode}
\index{negui\+::pgutilities@{negui\+::pgutilities}!remove\+\_\+simulation\+\_\+replicate\+\_\+output\+\_\+files@{remove\+\_\+simulation\+\_\+replicate\+\_\+output\+\_\+files}}
\index{remove\+\_\+simulation\+\_\+replicate\+\_\+output\+\_\+files@{remove\+\_\+simulation\+\_\+replicate\+\_\+output\+\_\+files}!negui\+::pgutilities@{negui\+::pgutilities}}
\subsubsection[{\texorpdfstring{remove\+\_\+simulation\+\_\+replicate\+\_\+output\+\_\+files(s\+\_\+basename)}{remove_simulation_replicate_output_files(s_basename)}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgutilities.\+remove\+\_\+simulation\+\_\+replicate\+\_\+output\+\_\+files (
\begin{DoxyParamCaption}
\item[{}]{s\+\_\+basename}
\end{DoxyParamCaption}
)}\hypertarget{namespacenegui_1_1pgutilities_aa37c7d125e4eaec2eeea639f53fa140d}{}\label{namespacenegui_1_1pgutilities_aa37c7d125e4eaec2eeea639f53fa140d}
\begin{DoxyVerb}When a sim is cancelled inside a PGGuiSimuPop
object, this def is called
to remove any output files produced by the
do_pgopsimupop_replicate_from_files
\end{DoxyVerb}
 

Definition at line 293 of file pgutilities.\+py.


\begin{DoxyCode}
293 \textcolor{keyword}{def }\hyperlink{namespacenegui_1_1pgutilities_aa37c7d125e4eaec2eeea639f53fa140d}{remove\_simulation\_replicate\_output\_files}( s\_basename ):
294     \textcolor{stringliteral}{'''}
295 \textcolor{stringliteral}{    When a sim is cancelled inside a PGGuiSimuPop}
296 \textcolor{stringliteral}{    object, this def is called}
297 \textcolor{stringliteral}{    to remove any output files produced by the}
298 \textcolor{stringliteral}{    do\_pgopsimupop\_replicate\_from\_files}
299 \textcolor{stringliteral}{    '''}
300 
301     \textcolor{comment}{#type is to coerce python 3, despite fact that any iterable}
302     \textcolor{comment}{#would probably suffice:}
303     ls\_output\_extentions=list( \(\backslash\)
304             pgout.PGOutputSimuPop.DICT\_OUTPUT\_FILE\_EXTENSIONS.values() )
305 
306     \textcolor{keywordflow}{for} s\_ext \textcolor{keywordflow}{in} ls\_output\_extentions:
307 
308         s\_unzipped\_file\_pattern=s\_basename + \textcolor{stringliteral}{"*"} \(\backslash\)
309                 + SIMULATION\_OUTPUT\_FILE\_REPLICATE\_TAG \(\backslash\)
310                 + \textcolor{stringliteral}{"*"} + s\_ext
311 
312         ls\_files\_unzipped=glob.glob( s\_unzipped\_file\_pattern )
313 
314         ls\_files\_zipped=glob.glob( s\_unzipped\_file\_pattern \(\backslash\)
315                 + \textcolor{stringliteral}{"."} + pgout.PGOutputSimuPop.COMPRESSION\_FILE\_EXTENSION )
316 
317         \textcolor{keywordflow}{for} s\_file \textcolor{keywordflow}{in} ls\_files\_unzipped + ls\_files\_zipped:
318             os.remove( s\_file )
319         \textcolor{comment}{#end for each unzipped and zipped output file with this extension}
320     \textcolor{comment}{#end for each file ext}
321 
322     \textcolor{keywordflow}{return}
323 \textcolor{comment}{#end remove\_simulation\_replicate\_output\_files}
324 
\end{DoxyCode}
\index{negui\+::pgutilities@{negui\+::pgutilities}!run\+\_\+driveneestimator\+\_\+in\+\_\+new\+\_\+process@{run\+\_\+driveneestimator\+\_\+in\+\_\+new\+\_\+process}}
\index{run\+\_\+driveneestimator\+\_\+in\+\_\+new\+\_\+process@{run\+\_\+driveneestimator\+\_\+in\+\_\+new\+\_\+process}!negui\+::pgutilities@{negui\+::pgutilities}}
\subsubsection[{\texorpdfstring{run\+\_\+driveneestimator\+\_\+in\+\_\+new\+\_\+process(o\+\_\+multiprocessing\+\_\+event, s\+\_\+genepop\+\_\+files, qs\+\_\+sample\+\_\+scheme\+\_\+args, f\+\_\+min\+\_\+allele\+\_\+freq, i\+\_\+replicates, qs\+\_\+loci\+\_\+sampling\+\_\+scheme\+\_\+args, i\+\_\+loci\+\_\+replicates, i\+\_\+num\+\_\+processes, s\+\_\+runmode, s\+\_\+outfile\+\_\+basename, s\+\_\+file\+\_\+delimiter="")}{run_driveneestimator_in_new_process(o_multiprocessing_event, s_genepop_files, qs_sample_scheme_args, f_min_allele_freq, i_replicates, qs_loci_sampling_scheme_args, i_loci_replicates, i_num_processes, s_runmode, s_outfile_basename, s_file_delimiter=")}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgutilities.\+run\+\_\+driveneestimator\+\_\+in\+\_\+new\+\_\+process (
\begin{DoxyParamCaption}
\item[{}]{o\+\_\+multiprocessing\+\_\+event, }
\item[{}]{s\+\_\+genepop\+\_\+files, }
\item[{}]{qs\+\_\+sample\+\_\+scheme\+\_\+args, }
\item[{}]{f\+\_\+min\+\_\+allele\+\_\+freq, }
\item[{}]{i\+\_\+replicates, }
\item[{}]{qs\+\_\+loci\+\_\+sampling\+\_\+scheme\+\_\+args, }
\item[{}]{i\+\_\+loci\+\_\+replicates, }
\item[{}]{i\+\_\+num\+\_\+processes, }
\item[{}]{s\+\_\+runmode, }
\item[{}]{s\+\_\+outfile\+\_\+basename, }
\item[{}]{s\+\_\+file\+\_\+delimiter = {\ttfamily \char`\"{}}}
\end{DoxyParamCaption}
)}\hypertarget{namespacenegui_1_1pgutilities_a177345979e44820072e37052d92bfd32}{}\label{namespacenegui_1_1pgutilities_a177345979e44820072e37052d92bfd32}
\begin{DoxyVerb}Similar to def above, "do_simulation_reps_in_subprocesses," this def is called from a
PGGuiNeEstimator instance, in def runEstimator(), which first spawns
a python multiprocessing.Process, which targest this def, and provides
it with the multiprocessing.Event that will signal it to abort and cleanup
(see above).

This def is simpler than the do_simulation_reps_in_subprocesses def, however, in that it
spawns only a single OS process, that calls python to execute pgdriveneestimator.py,
which itself multiplexes the NeAnlaysis of multiple genepop files and (likely) multiple
pops per file using python.multiprocessing.Process objects.
\end{DoxyVerb}
 

Definition at line 664 of file pgutilities.\+py.


\begin{DoxyCode}
664                                         s\_file\_delimiter=\textcolor{stringliteral}{","} ):
665     \textcolor{stringliteral}{'''}
666 \textcolor{stringliteral}{    Similar to def above, "do\_simulation\_reps\_in\_subprocesses," this def is called from a}
667 \textcolor{stringliteral}{    PGGuiNeEstimator instance, in def runEstimator(), which first spawns}
668 \textcolor{stringliteral}{    a python multiprocessing.Process, which targest this def, and provides}
669 \textcolor{stringliteral}{    it with the multiprocessing.Event that will signal it to abort and cleanup}
670 \textcolor{stringliteral}{    (see above).}
671 \textcolor{stringliteral}{}
672 \textcolor{stringliteral}{    This def is simpler than the do\_simulation\_reps\_in\_subprocesses def, however, in that it}
673 \textcolor{stringliteral}{    spawns only a single OS process, that calls python to execute pgdriveneestimator.py,}
674 \textcolor{stringliteral}{    which itself multiplexes the NeAnlaysis of multiple genepop files and (likely) multiple}
675 \textcolor{stringliteral}{    pops per file using python.multiprocessing.Process objects.}
676 \textcolor{stringliteral}{    '''}
677     \textcolor{keywordflow}{try}:
678         s\_os\_plaform\_name=platform.system()
679         
680         \textcolor{comment}{#if we're on windows, file}
681         \textcolor{comment}{#paths may be a mangled mix of unix and }
682         \textcolor{comment}{#windows separators -- with errors resulting}
683         \textcolor{comment}{#downstream.  So we standardize:}
684         \textcolor{keywordflow}{if} s\_os\_plaform\_name == \textcolor{stringliteral}{"windows"}:
685 
686             ls\_current\_file\_list=s\_genepop\_files.split( s\_file\_delimiter )
687             ls\_new\_file\_list=[]
688             \textcolor{keywordflow}{for} s\_file \textcolor{keywordflow}{in} ls\_current\_file\_list:
689                 ls\_new\_file\_list.append( fix\_windows\_path( s\_file ) )
690             \textcolor{comment}{#end for each file}
691             
692             \textcolor{comment}{#replace orig arg with new "fixed" file paths}
693             s\_genepop\_files=\textcolor{stringliteral}{","}.join( ls\_new\_file\_list )
694 
695             \textcolor{comment}{#also need to fix outile path:}
696             s\_outfile\_basename = fix\_windows\_path( s\_outfile\_basename )
697         \textcolor{comment}{#end if windows, fix file path strings}
698 
699         \textcolor{comment}{#get the correct format for pgdriveneestimator.py's file name parsing alg:}
700         s\_genepop\_files\_formatted\_as\_python\_list= \(\backslash\)
701                 \hyperlink{namespacenegui_1_1pgutilities_aed0f15b22462914445ffe1ec2a77cbc8}{convert\_genepop\_files\_string\_to\_list\_format}( 
      s\_genepop\_files )
702 
703         \textcolor{comment}{#caller, assumed to be a pgguineestimator instance,}
704         \textcolor{comment}{#will have "default" for the runmode val, }
705         \textcolor{comment}{#when no extra output is desired, and multiprocessing is also}
706         \textcolor{comment}{#desired.  We convert to the proper term used by pgdriveneestimator.py}
707         \textcolor{comment}{#to designate this type of run:}
708         \textcolor{keywordflow}{if} s\_runmode==\textcolor{stringliteral}{"default"}:
709             s\_runmode=\textcolor{stringliteral}{"no\_debug"}
710         \textcolor{comment}{#end if default runmode}
711 
712         \textcolor{comment}{#Make of a single sequence of strings.}
713         qs\_files\_args=( s\_genepop\_files\_formatted\_as\_python\_list, ) 
714 
715         \textcolor{comment}{#join tuples of arguments in the proper order}
716         \textcolor{comment}{#for the call to pgdriveneestimator.py:}
717         seq\_arg\_set=qs\_files\_args \(\backslash\)
718                         + qs\_sample\_scheme\_args \(\backslash\)
719                         + ( str( f\_min\_allele\_freq ), str( i\_replicates ) ) \(\backslash\)
720                         + qs\_loci\_sampling\_scheme\_args \(\backslash\)
721                         + ( str( i\_loci\_replicates ), str( i\_num\_processes ), s\_runmode ) 
722 
723         s\_main\_output\_filename=s\_outfile\_basename + \textcolor{stringliteral}{"."} \(\backslash\)
724                 + NE\_ESTIMATION\_MAIN\_TABLE\_FILE\_EXT
725 
726         s\_secondary\_output\_filename=s\_outfile\_basename + \textcolor{stringliteral}{"."} \(\backslash\)
727                 + NE\_ESTIMATION\_SECONDARY\_OUTPUT\_FILE\_EXT
728 
729         \textcolor{comment}{#pgdriveneestimator will write stdout and stderr, respectively}
730         \textcolor{comment}{#to these files:}
731         o\_main\_output=open( s\_main\_output\_filename, \textcolor{stringliteral}{'w'} )
732         o\_secondary\_output=open( s\_secondary\_output\_filename, \textcolor{stringliteral}{'w'} )
733 
734         seq\_arg\_set += ( o\_main\_output, o\_secondary\_output )
735         
736         \textcolor{comment}{#the driver also takes a final arg, ref to}
737         \textcolor{comment}{#the multiproc event -- and then checks for }
738         \textcolor{comment}{#it being set during map\_async when using multiprocesses}
739         \textcolor{comment}{#(see pgdriveneestimator.py def execute\_ne\_for\_each\_sample):}
740         seq\_arg\_set += ( o\_multiprocessing\_event, )
741 
742         pgne.mymain( *seq\_arg\_set )
743 
744         o\_main\_output.close()
745         o\_secondary\_output.close()
746     \textcolor{keywordflow}{except} Exception \textcolor{keyword}{as} oex:
747         show\_error\_in\_messagebox\_in\_new\_process( oex, 
748                 s\_msg\_prefix = \textcolor{stringliteral}{"Error caught by pgutilities, "}
749                                 + \textcolor{stringliteral}{"def run\_driveneestimator\_in\_new\_process."} )
750         \textcolor{keywordflow}{raise} oex
751     \textcolor{comment}{#end try...except...}
752 
753     \textcolor{keywordflow}{return}
754 \textcolor{comment}{#end run\_driveneestimator\_in\_new\_process}
755 
\end{DoxyCode}
