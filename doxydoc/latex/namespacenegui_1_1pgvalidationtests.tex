\hypertarget{namespacenegui_1_1pgvalidationtests}{}\section{negui.\+pgvalidationtests Namespace Reference}
\label{namespacenegui_1_1pgvalidationtests}\index{negui.\+pgvalidationtests@{negui.\+pgvalidationtests}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def {\bfseries get\+\_\+mean\+\_\+het\+\_\+per\+\_\+cycle} (o\+\_\+gp\+\_\+file, i\+\_\+initial\+\_\+cycle, i\+\_\+final\+\_\+cycle, i\+\_\+min\+\_\+loci\+\_\+number=None, i\+\_\+max\+\_\+loci\+\_\+number=None)\hypertarget{namespacenegui_1_1pgvalidationtests_abdedaca92f6f5d5805336dd4fd18e024}{}\label{namespacenegui_1_1pgvalidationtests_abdedaca92f6f5d5805336dd4fd18e024}

\item 
def {\bfseries get\+\_\+ne\+\_\+per\+\_\+cycle} (s\+\_\+genepop\+\_\+file, o\+\_\+tsv\+\_\+file, i\+\_\+initial\+\_\+cycle\+\_\+number, i\+\_\+final\+\_\+cycle\+\_\+number)\hypertarget{namespacenegui_1_1pgvalidationtests_afb63c4540c899abedfc31f3c900a4503}{}\label{namespacenegui_1_1pgvalidationtests_afb63c4540c899abedfc31f3c900a4503}

\item 
def {\bfseries get\+\_\+theoretical\+\_\+heterozygosity\+\_\+per\+\_\+generation} (df\+\_\+mean\+\_\+het\+\_\+by\+\_\+cycle, df\+\_\+ne\+\_\+by\+\_\+cycle, f\+\_\+cycles\+\_\+per\+\_\+generation, f\+\_\+theoretical\+\_\+ne=None)\hypertarget{namespacenegui_1_1pgvalidationtests_a4e442184f7a2ce77a351938557e4f42b}{}\label{namespacenegui_1_1pgvalidationtests_a4e442184f7a2ce77a351938557e4f42b}

\item 
def \hyperlink{namespacenegui_1_1pgvalidationtests_ab5c519679dcc75c116bcbd7883107cfb}{get\+\_\+theoretical\+\_\+het\+\_\+loss\+\_\+per\+\_\+generation} (df\+\_\+ne\+\_\+by\+\_\+cycle\+\_\+number, f\+\_\+cycles\+\_\+per\+\_\+generation, f\+\_\+theoretical\+\_\+ne=None)
\item 
def {\bfseries convert\+\_\+mean\+\_\+hets\+\_\+to\+\_\+het\+\_\+loss} (df\+\_\+mean\+\_\+het\+\_\+by\+\_\+gen)\hypertarget{namespacenegui_1_1pgvalidationtests_a5523f829bf2db243c0e01358eb13c694}{}\label{namespacenegui_1_1pgvalidationtests_a5523f829bf2db243c0e01358eb13c694}

\item 
def \hyperlink{namespacenegui_1_1pgvalidationtests_afbd41ca3bce1a778d97bd11efe270119}{plot\+\_\+two\+\_\+dicts\+\_\+similarly\+\_\+scaled} (d\+\_\+dict1, d\+\_\+dict2, s\+\_\+data1\+\_\+label=\char`\"{}\char`\"{}, s\+\_\+data2\+\_\+label=\char`\"{}\char`\"{}, s\+\_\+xaxis\+\_\+label=\char`\"{}\char`\"{}, s\+\_\+yaxis\+\_\+label=\char`\"{}\char`\"{}, s\+\_\+title=\char`\"{}\char`\"{}, s\+\_\+plot\+\_\+file\+\_\+name=None)
\item 
def \hyperlink{namespacenegui_1_1pgvalidationtests_acebbfd32727989f141b02f26e736b41c}{has\+\_\+requested\+\_\+cycle\+\_\+range} (o\+\_\+tsv\+\_\+file, i\+\_\+initial\+\_\+cycle\+\_\+number, i\+\_\+final\+\_\+cycle\+\_\+number)
\item 
def {\bfseries get\+\_\+mean\+\_\+hets\+\_\+and\+\_\+ne\+\_\+for\+\_\+cycles} (s\+\_\+ne\+\_\+tsv\+\_\+file, i\+\_\+initial\+\_\+cycle\+\_\+number, i\+\_\+final\+\_\+cycle\+\_\+number, i\+\_\+min\+\_\+loci\+\_\+number, i\+\_\+max\+\_\+loci\+\_\+number)\hypertarget{namespacenegui_1_1pgvalidationtests_a9d13db8def69ba2b1deeab9fd32eddf6}{}\label{namespacenegui_1_1pgvalidationtests_a9d13db8def69ba2b1deeab9fd32eddf6}

\item 
def {\bfseries get\+\_\+per\+\_\+generation\+\_\+het\+\_\+from\+\_\+per\+\_\+cycle\+\_\+het} (df\+\_\+het\+\_\+by\+\_\+cycle, f\+\_\+cycles\+\_\+per\+\_\+generation)\hypertarget{namespacenegui_1_1pgvalidationtests_a476166538477fd8ec295be2c1abd96d7}{}\label{namespacenegui_1_1pgvalidationtests_a476166538477fd8ec295be2c1abd96d7}

\item 
def \hyperlink{namespacenegui_1_1pgvalidationtests_ad83e2cd3fe77a764bb938366618034f1}{get\+\_\+expected\+\_\+vs\+\_\+observed\+\_\+heterozygosity} (s\+\_\+ne\+\_\+tsv\+\_\+file, i\+\_\+initial\+\_\+cycle\+\_\+number, i\+\_\+final\+\_\+cycle\+\_\+number, f\+\_\+cycles\+\_\+per\+\_\+generation, i\+\_\+min\+\_\+loci\+\_\+number=None, i\+\_\+max\+\_\+loci\+\_\+number=None, f\+\_\+theoretical\+\_\+ne=None, b\+\_\+plot=True, s\+\_\+plot\+\_\+file=None, s\+\_\+plot\+\_\+type=\char`\"{}png\char`\"{})
\item 
def \hyperlink{namespacenegui_1_1pgvalidationtests_a0b82e2c871359b7ca528866f4dcd7ed5}{get\+\_\+expected\+\_\+vs\+\_\+observed\+\_\+loss\+\_\+heterozygosity} (s\+\_\+ne\+\_\+tsv\+\_\+file, i\+\_\+initial\+\_\+cycle\+\_\+number, i\+\_\+final\+\_\+cycle\+\_\+number, f\+\_\+cycles\+\_\+per\+\_\+generation, i\+\_\+min\+\_\+loci\+\_\+number=None, i\+\_\+max\+\_\+loci\+\_\+number=None, f\+\_\+theoretical\+\_\+ne=None, b\+\_\+plot=True, s\+\_\+plot\+\_\+file=None, s\+\_\+plot\+\_\+type=\char`\"{}png\char`\"{})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
bool {\bfseries b\+\_\+can\+\_\+plot} = True\hypertarget{namespacenegui_1_1pgvalidationtests_ab0c1159f0713697a25481675023fc667}{}\label{namespacenegui_1_1pgvalidationtests_ab0c1159f0713697a25481675023fc667}

\item 
list {\bfseries L\+S\+\_\+\+A\+R\+G\+S\+\_\+\+S\+H\+O\+RT} = \mbox{[} \char`\"{}-\/t\char`\"{}, \char`\"{}-\/i\char`\"{} , \char`\"{}-\/f\char`\"{} , \char`\"{}-\/g\char`\"{}, \char`\"{}-\/n\char`\"{}, \char`\"{}-\/m\char`\"{}, \char`\"{}-\/s\char`\"{} \mbox{]}\hypertarget{namespacenegui_1_1pgvalidationtests_a66c3e337805a10d83f2f0b462c720b6c}{}\label{namespacenegui_1_1pgvalidationtests_a66c3e337805a10d83f2f0b462c720b6c}

\item 
list {\bfseries L\+S\+\_\+\+A\+R\+G\+S\+\_\+\+L\+O\+NG} = \mbox{[} \char`\"{}-\/-\/tsvfile\char`\"{} , \char`\"{}-\/-\/initialcycle\char`\"{}, \char`\"{}-\/-\/finalcycle\char`\"{}, \char`\"{}-\/-\/cyclespergen\char`\"{}, \char`\"{}-\/-\/minloci\char`\"{}, \char`\"{}-\/-\/maxloci\char`\"{}, \char`\"{}-\/-\/test\char`\"{} \mbox{]}\hypertarget{namespacenegui_1_1pgvalidationtests_a1385b3581e58fda3e16c9b91905cfda3}{}\label{namespacenegui_1_1pgvalidationtests_a1385b3581e58fda3e16c9b91905cfda3}

\item 
list {\bfseries L\+S\+\_\+\+A\+R\+G\+S\+\_\+\+H\+E\+LP}
\item 
list {\bfseries L\+S\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+A\+R\+G\+S\+\_\+\+S\+H\+O\+RT} = \mbox{[} \char`\"{}-\/e\char`\"{} \mbox{]}\hypertarget{namespacenegui_1_1pgvalidationtests_a7e351d7f60d7dcd3b8bc7714d63dd2e9}{}\label{namespacenegui_1_1pgvalidationtests_a7e351d7f60d7dcd3b8bc7714d63dd2e9}

\item 
list {\bfseries L\+S\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+A\+R\+G\+S\+\_\+\+L\+O\+NG} = \mbox{[} \char`\"{}-\/-\/expectedne\char`\"{} \mbox{]}\hypertarget{namespacenegui_1_1pgvalidationtests_aa787bcaac3647fc826bbbab425b5305b}{}\label{namespacenegui_1_1pgvalidationtests_aa787bcaac3647fc826bbbab425b5305b}

\item 
list {\bfseries L\+S\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+A\+R\+G\+S\+\_\+\+H\+E\+LP}
\item 
dictionary {\bfseries ddefs\+\_\+by\+\_\+test\+\_\+name}
\item 
{\bfseries o\+\_\+parser} = ap.\+Argument\+Parser()\hypertarget{namespacenegui_1_1pgvalidationtests_a50ef8ea2e3d1ce48dae1a52281b55225}{}\label{namespacenegui_1_1pgvalidationtests_a50ef8ea2e3d1ce48dae1a52281b55225}

\item 
{\bfseries o\+\_\+arglist} = o\+\_\+parser.\+add\+\_\+argument\+\_\+group( \char`\"{}args\char`\"{} )\hypertarget{namespacenegui_1_1pgvalidationtests_ab9f024687956a0518e72b7cb46db11c7}{}\label{namespacenegui_1_1pgvalidationtests_ab9f024687956a0518e72b7cb46db11c7}

\item 
{\bfseries i\+\_\+total\+\_\+nonopt} = len( L\+S\+\_\+\+A\+R\+G\+S\+\_\+\+S\+H\+O\+RT )\hypertarget{namespacenegui_1_1pgvalidationtests_a39cc243a19df8fa60b00814f6efaf189}{}\label{namespacenegui_1_1pgvalidationtests_a39cc243a19df8fa60b00814f6efaf189}

\item 
{\bfseries i\+\_\+total\+\_\+opt} = len( L\+S\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+A\+R\+G\+S\+\_\+\+S\+H\+O\+RT )\hypertarget{namespacenegui_1_1pgvalidationtests_ad847e140356417b41911a410c3b65b08}{}\label{namespacenegui_1_1pgvalidationtests_ad847e140356417b41911a410c3b65b08}

\item 
{\bfseries help}\hypertarget{namespacenegui_1_1pgvalidationtests_abbbef1bbd31d564a71ee35f3321a437e}{}\label{namespacenegui_1_1pgvalidationtests_abbbef1bbd31d564a71ee35f3321a437e}

\item 
{\bfseries required}\hypertarget{namespacenegui_1_1pgvalidationtests_a4e6369b67884cc7838e120558917a4e2}{}\label{namespacenegui_1_1pgvalidationtests_a4e6369b67884cc7838e120558917a4e2}

\item 
{\bfseries o\+\_\+args} = o\+\_\+parser.\+parse\+\_\+args()\hypertarget{namespacenegui_1_1pgvalidationtests_abd540a5c4a3f7be3299f8e746151bce4}{}\label{namespacenegui_1_1pgvalidationtests_abd540a5c4a3f7be3299f8e746151bce4}

\item 
{\bfseries s\+\_\+tsv\+\_\+file} = o\+\_\+args.\+tsvfile\hypertarget{namespacenegui_1_1pgvalidationtests_a29b3e95bfd18429a77cbaea834a0ad77}{}\label{namespacenegui_1_1pgvalidationtests_a29b3e95bfd18429a77cbaea834a0ad77}

\item 
{\bfseries i\+\_\+initial\+\_\+cycle} = int( o\+\_\+args.\+initialcycle )\hypertarget{namespacenegui_1_1pgvalidationtests_afadb9e13827670269a693d44e6acefc1}{}\label{namespacenegui_1_1pgvalidationtests_afadb9e13827670269a693d44e6acefc1}

\item 
{\bfseries i\+\_\+final\+\_\+cycle} = int( o\+\_\+args.\+finalcycle )\hypertarget{namespacenegui_1_1pgvalidationtests_ac5cfe3d2543203419370d6e619f10652}{}\label{namespacenegui_1_1pgvalidationtests_ac5cfe3d2543203419370d6e619f10652}

\item 
{\bfseries f\+\_\+cycles\+\_\+per\+\_\+generation} = float( o\+\_\+args.\+cyclespergen )\hypertarget{namespacenegui_1_1pgvalidationtests_a781c5738c4ccd5a03bd839107f37c125}{}\label{namespacenegui_1_1pgvalidationtests_a781c5738c4ccd5a03bd839107f37c125}

\item 
{\bfseries i\+\_\+min\+\_\+loci} = int( o\+\_\+args.\+minloci )\hypertarget{namespacenegui_1_1pgvalidationtests_a49c9edded3d6f6d48210e7b10dd44dd5}{}\label{namespacenegui_1_1pgvalidationtests_a49c9edded3d6f6d48210e7b10dd44dd5}

\item 
{\bfseries i\+\_\+max\+\_\+loci} = int( o\+\_\+args.\+maxloci )\hypertarget{namespacenegui_1_1pgvalidationtests_aec1b97b9559a116c069a261a1415a6b1}{}\label{namespacenegui_1_1pgvalidationtests_aec1b97b9559a116c069a261a1415a6b1}

\item 
{\bfseries s\+\_\+test\+\_\+name} = o\+\_\+args.\+test\hypertarget{namespacenegui_1_1pgvalidationtests_a928c5205a2f691d2d8134347d800ef52}{}\label{namespacenegui_1_1pgvalidationtests_a928c5205a2f691d2d8134347d800ef52}

\item 
{\bfseries r\+\_\+def\+\_\+to\+\_\+call} = None\hypertarget{namespacenegui_1_1pgvalidationtests_a668820c5f2187a6b9551fcd4d0c7dead}{}\label{namespacenegui_1_1pgvalidationtests_a668820c5f2187a6b9551fcd4d0c7dead}

\item 
{\bfseries f\+\_\+expected\+\_\+ne} = float( o\+\_\+args.\+expectedne )\hypertarget{namespacenegui_1_1pgvalidationtests_a33b6dbdb04d536afef35d90800e0c307}{}\label{namespacenegui_1_1pgvalidationtests_a33b6dbdb04d536afef35d90800e0c307}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Description
We needed a suite of tests to validate the simulation and nb output.  
The first of these requested by Gordon is a comparison of expected
hegerozygosity, calculated from the Ne value, for the tth generation
as ( 1-2/Ne )**t, vs  the "observed" 
loss of heterozygosity, calculated for each generation as the mean ( 1-He ), with
He_l = sum_i_l=1 to n_l (i_l**2), with i_l=allele freq of the ith of n alleles 
for the lth loci.


2017_02_22
We've clarified that we will add a cycles/generation ratio to our input values
in order to correctly implement the theoretical vs expected values. Note that
plotting for most of our model species by sim breeding cycles, implying a 1/1
breeding cycle per generation ratio for measuring heterozygosity, shows 
inaccurate declines, expected vs theoretical.
\end{DoxyVerb}
 

\subsection{Function Documentation}
\index{negui\+::pgvalidationtests@{negui\+::pgvalidationtests}!get\+\_\+expected\+\_\+vs\+\_\+observed\+\_\+heterozygosity@{get\+\_\+expected\+\_\+vs\+\_\+observed\+\_\+heterozygosity}}
\index{get\+\_\+expected\+\_\+vs\+\_\+observed\+\_\+heterozygosity@{get\+\_\+expected\+\_\+vs\+\_\+observed\+\_\+heterozygosity}!negui\+::pgvalidationtests@{negui\+::pgvalidationtests}}
\subsubsection[{\texorpdfstring{get\+\_\+expected\+\_\+vs\+\_\+observed\+\_\+heterozygosity(s\+\_\+ne\+\_\+tsv\+\_\+file, i\+\_\+initial\+\_\+cycle\+\_\+number, i\+\_\+final\+\_\+cycle\+\_\+number, f\+\_\+cycles\+\_\+per\+\_\+generation, i\+\_\+min\+\_\+loci\+\_\+number=\+None, i\+\_\+max\+\_\+loci\+\_\+number=\+None, f\+\_\+theoretical\+\_\+ne=\+None, b\+\_\+plot=\+True, s\+\_\+plot\+\_\+file=\+None, s\+\_\+plot\+\_\+type=""png"")}{get_expected_vs_observed_heterozygosity(s_ne_tsv_file, i_initial_cycle_number, i_final_cycle_number, f_cycles_per_generation, i_min_loci_number=None, i_max_loci_number=None, f_theoretical_ne=None, b_plot=True, s_plot_file=None, s_plot_type="png")}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgvalidationtests.\+get\+\_\+expected\+\_\+vs\+\_\+observed\+\_\+heterozygosity (
\begin{DoxyParamCaption}
\item[{}]{s\+\_\+ne\+\_\+tsv\+\_\+file, }
\item[{}]{i\+\_\+initial\+\_\+cycle\+\_\+number, }
\item[{}]{i\+\_\+final\+\_\+cycle\+\_\+number, }
\item[{}]{f\+\_\+cycles\+\_\+per\+\_\+generation, }
\item[{}]{i\+\_\+min\+\_\+loci\+\_\+number = {\ttfamily None}, }
\item[{}]{i\+\_\+max\+\_\+loci\+\_\+number = {\ttfamily None}, }
\item[{}]{f\+\_\+theoretical\+\_\+ne = {\ttfamily None}, }
\item[{}]{b\+\_\+plot = {\ttfamily True}, }
\item[{}]{s\+\_\+plot\+\_\+file = {\ttfamily None}, }
\item[{}]{s\+\_\+plot\+\_\+type = {\ttfamily \char`\"{}png\char`\"{}}}
\end{DoxyParamCaption}
)}\hypertarget{namespacenegui_1_1pgvalidationtests_ad83e2cd3fe77a764bb938366618034f1}{}\label{namespacenegui_1_1pgvalidationtests_ad83e2cd3fe77a764bb938366618034f1}
\begin{DoxyVerb}This def is designed to use either a user-supplied theoretical Ne, or to
use the mean estimates in the tsv file for the theoretical Ne, and, for
the initial heterozygosity the mean HW expected via allele frequencies
for the first (initial) cycle.  The theoretical het for the ith generation
is calculated as
    Hz_i=Hz_{i-1} X ( 1 - 1/(2Ne) )

For the expected het for each cycle:
        sum_1_to_L(  1 - sum_1_to_A( allele-frequency_ij ** 2 ) )/L, in a cycle
        (pop section) with L loci, and each loci with some total alleles A, i=ith loci,
        j=jth allele.

Assumption:  that the (genepop) file(s) named in column one of the s_ne_tsv_file 
        argument exist and have either absolute paths (the current
        default method used to write them to the tsv file), or relative
        paths that are accessible from the working directory of the
        current python environment.

param s_ne_tsv_file, names the table file output from using module
    pgdriveneestimator.py to generate ne estimations, either
    via the negui interface or the command line use of pgdriveneestimator.py 
    itself, on genepop files generated by the negui implementation of
    the AgeStructureNe simulation driver.
param i_initial_cycle_number, integer giving the ith pop section,
    where i is the poplulation (cycle) that gives the initital Ne value on which
    to base the expected loss of het, that is the Ne value in ( 1-2/Ne )^t for
    each subsequent cycle t.
param i_final_cycle_number, if not None, then an integer giving the highest pop section
    (cycle) value to analyze.  If None, then analyze all pop sections with numbers 
    >= i_initial_cycle_number
param f_cycles_per_generation.  gives the number of breeding cycles per generation, so
    that theoretical interations are done per generation (not per cycle, unless 
    cycles per generation is 1.0
param i_min_loci_number, if not none than the He calculation will not use any of the loci
        in the range 1 to i, where i_min_loci_number is i + 1.
param i_ma_loci_number, if not none than the He calculation will not use any of the N loci
        in the range j to N, where i_man_loci_number is j - 1.

param b_plot, if true and maplotlib was importable, then a plot will be done.
param s_plot_file, if not none and b_plot is true, then plot to file with this name.
        If s_plot_file is None, then call pyplot.show() after the plot command.
param s_plot_type, if b_plot is true and s_plot_file is not None, the file type
        to be written is given by this extension, defaulting to png.\end{DoxyVerb}
 

Definition at line 498 of file pgvalidationtests.\+py.


\begin{DoxyCode}
498                                             s\_plot\_type=\textcolor{stringliteral}{"png"} ):
499 
500     \textcolor{stringliteral}{'''}
501 \textcolor{stringliteral}{    This def is designed to use either a user-supplied theoretical Ne, or to}
502 \textcolor{stringliteral}{    use the mean estimates in the tsv file for the theoretical Ne, and, for}
503 \textcolor{stringliteral}{    the initial heterozygosity the mean HW expected via allele frequencies}
504 \textcolor{stringliteral}{    for the first (initial) cycle.  The theoretical het for the ith generation}
505 \textcolor{stringliteral}{    is calculated as}
506 \textcolor{stringliteral}{        Hz\_i=Hz\_\{i-1\} X ( 1 - 1/(2Ne) )}
507 \textcolor{stringliteral}{}
508 \textcolor{stringliteral}{    For the expected het for each cycle:}
509 \textcolor{stringliteral}{            sum\_1\_to\_L(  1 - sum\_1\_to\_A( allele-frequency\_ij ** 2 ) )/L, in a cycle}
510 \textcolor{stringliteral}{            (pop section) with L loci, and each loci with some total alleles A, i=ith loci,}
511 \textcolor{stringliteral}{            j=jth allele.}
512 \textcolor{stringliteral}{}
513 \textcolor{stringliteral}{    Assumption:  that the (genepop) file(s) named in column one of the s\_ne\_tsv\_file }
514 \textcolor{stringliteral}{            argument exist and have either absolute paths (the current}
515 \textcolor{stringliteral}{            default method used to write them to the tsv file), or relative}
516 \textcolor{stringliteral}{            paths that are accessible from the working directory of the}
517 \textcolor{stringliteral}{            current python environment.}
518 \textcolor{stringliteral}{}
519 \textcolor{stringliteral}{    param s\_ne\_tsv\_file, names the table file output from using module}
520 \textcolor{stringliteral}{        pgdriveneestimator.py to generate ne estimations, either}
521 \textcolor{stringliteral}{        via the negui interface or the command line use of pgdriveneestimator.py }
522 \textcolor{stringliteral}{        itself, on genepop files generated by the negui implementation of}
523 \textcolor{stringliteral}{        the AgeStructureNe simulation driver.}
524 \textcolor{stringliteral}{    param i\_initial\_cycle\_number, integer giving the ith pop section,}
525 \textcolor{stringliteral}{        where i is the poplulation (cycle) that gives the initital Ne value on which}
526 \textcolor{stringliteral}{        to base the expected loss of het, that is the Ne value in ( 1-2/Ne )^t for}
527 \textcolor{stringliteral}{        each subsequent cycle t.}
528 \textcolor{stringliteral}{    param i\_final\_cycle\_number, if not None, then an integer giving the highest pop section}
529 \textcolor{stringliteral}{        (cycle) value to analyze.  If None, then analyze all pop sections with numbers }
530 \textcolor{stringliteral}{        >= i\_initial\_cycle\_number}
531 \textcolor{stringliteral}{    param f\_cycles\_per\_generation.  gives the number of breeding cycles per generation, so}
532 \textcolor{stringliteral}{        that theoretical interations are done per generation (not per cycle, unless }
533 \textcolor{stringliteral}{        cycles per generation is 1.0}
534 \textcolor{stringliteral}{    param i\_min\_loci\_number, if not none than the He calculation will not use any of the loci}
535 \textcolor{stringliteral}{            in the range 1 to i, where i\_min\_loci\_number is i + 1.}
536 \textcolor{stringliteral}{    param i\_ma\_loci\_number, if not none than the He calculation will not use any of the N loci}
537 \textcolor{stringliteral}{            in the range j to N, where i\_man\_loci\_number is j - 1.}
538 \textcolor{stringliteral}{}
539 \textcolor{stringliteral}{    param b\_plot, if true and maplotlib was importable, then a plot will be done.}
540 \textcolor{stringliteral}{    param s\_plot\_file, if not none and b\_plot is true, then plot to file with this name.}
541 \textcolor{stringliteral}{            If s\_plot\_file is None, then call pyplot.show() after the plot command.}
542 \textcolor{stringliteral}{    param s\_plot\_type, if b\_plot is true and s\_plot\_file is not None, the file type}
543 \textcolor{stringliteral}{            to be written is given by this extension, defaulting to png.}
544 \textcolor{stringliteral}{}
545 \textcolor{stringliteral}{    '''}
546     
547 
548     ddf\_mean\_het\_by\_gp\_file\_by\_cycle, ddf\_ne\_by\_gp\_file\_by\_cycle = \(\backslash\)
549             get\_mean\_hets\_and\_ne\_for\_cycles( s\_ne\_tsv\_file, 
550                                                 i\_initial\_cycle\_number,
551                                                 i\_final\_cycle\_number, 
552                                                 i\_min\_loci\_number, 
553                                                 i\_max\_loci\_number )
554 
555     \textcolor{keywordflow}{for} s\_gp\_file\_name \textcolor{keywordflow}{in} ddf\_mean\_het\_by\_gp\_file\_by\_cycle:
556 
557         df\_het\_per\_cycle=ddf\_mean\_het\_by\_gp\_file\_by\_cycle[ s\_gp\_file\_name ]
558 
559         df\_expected\_het\_by\_gen=get\_per\_generation\_het\_from\_per\_cycle\_het( df\_het\_per\_cycle, 
560                                                                             f\_cycles\_per\_generation )
561 
562         df\_theoretical\_het\_by\_gen=\(\backslash\)
563             get\_theoretical\_heterozygosity\_per\_generation( df\_het\_per\_cycle,
564                                                             ddf\_ne\_by\_gp\_file\_by\_cycle[ s\_gp\_file\_name ],
565                                                             f\_cycles\_per\_generation,
566                                                             f\_theoretical\_ne )
567         \textcolor{keywordflow}{if} b\_plot == \textcolor{keyword}{True} \textcolor{keywordflow}{and} b\_can\_plot == \textcolor{keyword}{True}:
568             
569             f\_ne0=f\_theoretical\_ne \textcolor{keywordflow}{if} f\_theoretical\_ne \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \(\backslash\)
570                     \textcolor{keywordflow}{else} np.mean(  list( ddf\_ne\_by\_gp\_file\_by\_cycle[ s\_gp\_file\_name ].values() ) )          
571 
572             f\_he0=ddf\_mean\_het\_by\_gp\_file\_by\_cycle[ s\_gp\_file\_name ][ i\_initial\_cycle\_number ]
573 
574             s\_title=\textcolor{stringliteral}{"Expected vs. theoretical heterozygosity"} \(\backslash\)
575                 + \textcolor{stringliteral}{"\(\backslash\)nSim cycles: "} \(\backslash\)
576                 + str( i\_initial\_cycle\_number ) \(\backslash\)
577                 + \textcolor{stringliteral}{"-"} + str( i\_final\_cycle\_number ) + \textcolor{stringliteral}{"."} \(\backslash\)
578                 + \textcolor{stringliteral}{".  Ne for theoretical: "} + str( f\_ne0 ) \(\backslash\)
579                 + \textcolor{stringliteral}{".  Hz of initial gen: "} \(\backslash\)
580                 + str( round( f\_he0, 4) ) \(\backslash\)
581                 + \textcolor{stringliteral}{"\(\backslash\)nCycles per generation: "} \(\backslash\)
582                 + str ( int ( round( f\_cycles\_per\_generation ) ) ) + \textcolor{stringliteral}{"."}
583 
584             s\_het\_label=\textcolor{stringliteral}{"expected under HW, using allele freqs"}
585             s\_theoretical\_label=\textcolor{stringliteral}{"theoretical, Hz\_i = Hz\_\{i-1\} X ( 1 - 1/(2Ne) )"}
586 
587             s\_xaxis\_label=\textcolor{stringliteral}{"generation"}
588             s\_yaxis\_label=\textcolor{stringliteral}{"heterozygosity"}
589             
590             \hyperlink{namespacenegui_1_1pgvalidationtests_afbd41ca3bce1a778d97bd11efe270119}{plot\_two\_dicts\_similarly\_scaled}( df\_expected\_het\_by\_gen, 
591                                         df\_theoretical\_het\_by\_gen, 
592                                         s\_data1\_label=s\_het\_label,
593                                         s\_data2\_label=s\_theoretical\_label,
594                                         s\_xaxis\_label=s\_xaxis\_label,
595                                         s\_yaxis\_label=s\_yaxis\_label,
596                                         s\_title=s\_title )
597         \textcolor{comment}{#end if plot is true}
598 
599     \textcolor{comment}{#end for each genepop file named in the tsv file}
600 
601     \textcolor{keywordflow}{return} \{ \textcolor{stringliteral}{"mean\_hets"} : ddf\_mean\_het\_by\_gp\_file\_by\_cycle, 
602                     \textcolor{stringliteral}{"nes"}: ddf\_ne\_by\_gp\_file\_by\_cycle  \}
603 \textcolor{comment}{#end get\_expected\_vs\_observed\_heterozygosity}
604         
\end{DoxyCode}
\index{negui\+::pgvalidationtests@{negui\+::pgvalidationtests}!get\+\_\+expected\+\_\+vs\+\_\+observed\+\_\+loss\+\_\+heterozygosity@{get\+\_\+expected\+\_\+vs\+\_\+observed\+\_\+loss\+\_\+heterozygosity}}
\index{get\+\_\+expected\+\_\+vs\+\_\+observed\+\_\+loss\+\_\+heterozygosity@{get\+\_\+expected\+\_\+vs\+\_\+observed\+\_\+loss\+\_\+heterozygosity}!negui\+::pgvalidationtests@{negui\+::pgvalidationtests}}
\subsubsection[{\texorpdfstring{get\+\_\+expected\+\_\+vs\+\_\+observed\+\_\+loss\+\_\+heterozygosity(s\+\_\+ne\+\_\+tsv\+\_\+file, i\+\_\+initial\+\_\+cycle\+\_\+number, i\+\_\+final\+\_\+cycle\+\_\+number, f\+\_\+cycles\+\_\+per\+\_\+generation, i\+\_\+min\+\_\+loci\+\_\+number=\+None, i\+\_\+max\+\_\+loci\+\_\+number=\+None, f\+\_\+theoretical\+\_\+ne=\+None, b\+\_\+plot=\+True, s\+\_\+plot\+\_\+file=\+None, s\+\_\+plot\+\_\+type=""png"")}{get_expected_vs_observed_loss_heterozygosity(s_ne_tsv_file, i_initial_cycle_number, i_final_cycle_number, f_cycles_per_generation, i_min_loci_number=None, i_max_loci_number=None, f_theoretical_ne=None, b_plot=True, s_plot_file=None, s_plot_type="png")}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgvalidationtests.\+get\+\_\+expected\+\_\+vs\+\_\+observed\+\_\+loss\+\_\+heterozygosity (
\begin{DoxyParamCaption}
\item[{}]{s\+\_\+ne\+\_\+tsv\+\_\+file, }
\item[{}]{i\+\_\+initial\+\_\+cycle\+\_\+number, }
\item[{}]{i\+\_\+final\+\_\+cycle\+\_\+number, }
\item[{}]{f\+\_\+cycles\+\_\+per\+\_\+generation, }
\item[{}]{i\+\_\+min\+\_\+loci\+\_\+number = {\ttfamily None}, }
\item[{}]{i\+\_\+max\+\_\+loci\+\_\+number = {\ttfamily None}, }
\item[{}]{f\+\_\+theoretical\+\_\+ne = {\ttfamily None}, }
\item[{}]{b\+\_\+plot = {\ttfamily True}, }
\item[{}]{s\+\_\+plot\+\_\+file = {\ttfamily None}, }
\item[{}]{s\+\_\+plot\+\_\+type = {\ttfamily \char`\"{}png\char`\"{}}}
\end{DoxyParamCaption}
)}\hypertarget{namespacenegui_1_1pgvalidationtests_a0b82e2c871359b7ca528866f4dcd7ed5}{}\label{namespacenegui_1_1pgvalidationtests_a0b82e2c871359b7ca528866f4dcd7ed5}
\begin{DoxyVerb}This def is designed to use a theoretical Ne value, either as passed by
caller, or the mean of estimates in the tsv file for the cycles initaial to final.
to use in the caluculation,
        1 - ( 1 - 1/(2Ne) )**t
for the tth generation This is then compared to the loss as computed by
Het=sum_i_to_L(  1 - sum_j_to_A( allele-frequency ** 2 ) )/L, in a generation
(pop section, for a cycle that is the first in a generation series, as given
by cycles per generation, starting with the initial, its individuals with
L loci, and each loci having some L alleles.

Assumption:  that the (genepop) file(s) named in column one of the s_ne_tsv_file 
        argument exist and have either absolute paths (the current
        default method used to write them to the tsv file), or relative
        paths that are accessible from the working directory of the
        current python environment.

param s_ne_tsv_file, names the table file output from using module
    pgdriveneestimator.py to generate ne estimations, either
    via the negui interface or the command line use of pgdriveneestimator.py 
    itself, on genepop files generated by the negui implementation of
    the AgeStructureNe simulation driver.
param i_initial_cycle_number, integer giving the ith pop section,
    where i is the poplulation (cycle) that gives the initital Ne value on which
    to base the expected loss of het, that is the Ne value in ( 1-2/Ne )^t for
    each subsequent cycle t.
param i_final_cycle_number, if not None, then an integer giving the highest pop section
    (cycle) value to analyze.  If None, then analyze all pop sections with numbers 
    >= i_initial_cycle_number
param f_cycles_per_generation, number of breeding cycles comprising a generation.
param i_min_loci_number, if not none than the He calculation will not use any of the loci
        in the range 1 to i, where i_min_loci_number is i + 1.
param i_ma_loci_number, if not none than the He calculation will not use any of the N loci
        in the range j to N, where i_man_loci_number is j - 1.

param b_plot, if true and maplotlib was importable, then a plot will be done.
param s_plot_file, if not none and b_plot is true, then plot to file with this name.
        If s_plot_file is None, then call pyplot.show() after the plot command.
param s_plot_type, if b_plot is true and s_plot_file is not None, the file type
        to be written is given by this extension, defaulting to png.\end{DoxyVerb}
\begin{DoxyVerb}The file_names property of the tsv file manager object
yields the set (ie.unique values, but returned as a list) 
of file names in column 1 of the tsv file:
\end{DoxyVerb}
 

Definition at line 614 of file pgvalidationtests.\+py.


\begin{DoxyCode}
614                                                             s\_plot\_type=\textcolor{stringliteral}{"png"} ):
615 
616     \textcolor{stringliteral}{'''}
617 \textcolor{stringliteral}{    This def is designed to use a theoretical Ne value, either as passed by}
618 \textcolor{stringliteral}{    caller, or the mean of estimates in the tsv file for the cycles initaial to final.}
619 \textcolor{stringliteral}{    to use in the caluculation,}
620 \textcolor{stringliteral}{            1 - ( 1 - 1/(2Ne) )**t}
621 \textcolor{stringliteral}{    for the tth generation This is then compared to the loss as computed by}
622 \textcolor{stringliteral}{    Het=sum\_i\_to\_L(  1 - sum\_j\_to\_A( allele-frequency ** 2 ) )/L, in a generation}
623 \textcolor{stringliteral}{    (pop section, for a cycle that is the first in a generation series, as given}
624 \textcolor{stringliteral}{    by cycles per generation, starting with the initial, its individuals with}
625 \textcolor{stringliteral}{    L loci, and each loci having some L alleles.}
626 \textcolor{stringliteral}{}
627 \textcolor{stringliteral}{    Assumption:  that the (genepop) file(s) named in column one of the s\_ne\_tsv\_file }
628 \textcolor{stringliteral}{            argument exist and have either absolute paths (the current}
629 \textcolor{stringliteral}{            default method used to write them to the tsv file), or relative}
630 \textcolor{stringliteral}{            paths that are accessible from the working directory of the}
631 \textcolor{stringliteral}{            current python environment.}
632 \textcolor{stringliteral}{}
633 \textcolor{stringliteral}{    param s\_ne\_tsv\_file, names the table file output from using module}
634 \textcolor{stringliteral}{        pgdriveneestimator.py to generate ne estimations, either}
635 \textcolor{stringliteral}{        via the negui interface or the command line use of pgdriveneestimator.py }
636 \textcolor{stringliteral}{        itself, on genepop files generated by the negui implementation of}
637 \textcolor{stringliteral}{        the AgeStructureNe simulation driver.}
638 \textcolor{stringliteral}{    param i\_initial\_cycle\_number, integer giving the ith pop section,}
639 \textcolor{stringliteral}{        where i is the poplulation (cycle) that gives the initital Ne value on which}
640 \textcolor{stringliteral}{        to base the expected loss of het, that is the Ne value in ( 1-2/Ne )^t for}
641 \textcolor{stringliteral}{        each subsequent cycle t.}
642 \textcolor{stringliteral}{    param i\_final\_cycle\_number, if not None, then an integer giving the highest pop section}
643 \textcolor{stringliteral}{        (cycle) value to analyze.  If None, then analyze all pop sections with numbers }
644 \textcolor{stringliteral}{        >= i\_initial\_cycle\_number}
645 \textcolor{stringliteral}{    param f\_cycles\_per\_generation, number of breeding cycles comprising a generation.}
646 \textcolor{stringliteral}{    param i\_min\_loci\_number, if not none than the He calculation will not use any of the loci}
647 \textcolor{stringliteral}{            in the range 1 to i, where i\_min\_loci\_number is i + 1.}
648 \textcolor{stringliteral}{    param i\_ma\_loci\_number, if not none than the He calculation will not use any of the N loci}
649 \textcolor{stringliteral}{            in the range j to N, where i\_man\_loci\_number is j - 1.}
650 \textcolor{stringliteral}{}
651 \textcolor{stringliteral}{    param b\_plot, if true and maplotlib was importable, then a plot will be done.}
652 \textcolor{stringliteral}{    param s\_plot\_file, if not none and b\_plot is true, then plot to file with this name.}
653 \textcolor{stringliteral}{            If s\_plot\_file is None, then call pyplot.show() after the plot command.}
654 \textcolor{stringliteral}{    param s\_plot\_type, if b\_plot is true and s\_plot\_file is not None, the file type}
655 \textcolor{stringliteral}{            to be written is given by this extension, defaulting to png.}
656 \textcolor{stringliteral}{}
657 \textcolor{stringliteral}{    '''}
658 
659     \textcolor{stringliteral}{'''}
660 \textcolor{stringliteral}{    The file\_names property of the tsv file manager object}
661 \textcolor{stringliteral}{    yields the set (ie.unique values, but returned as a list) }
662 \textcolor{stringliteral}{    of file names in column 1 of the tsv file:}
663 \textcolor{stringliteral}{    '''}
664 
665     ddf\_mean\_het\_by\_gp\_file\_by\_cycle, ddf\_ne\_by\_gp\_file\_by\_cycle = \(\backslash\)
666             get\_mean\_hets\_and\_ne\_for\_cycles( s\_ne\_tsv\_file, 
667                                                 i\_initial\_cycle\_number,
668                                                 i\_final\_cycle\_number, 
669                                                 i\_min\_loci\_number, 
670                                                 i\_max\_loci\_number )
671 
672     \textcolor{comment}{#Two dicts for the return value:}
673     ddf\_expected\_het\_loss\_by\_file=\{\}
674     ddf\_theoretical\_het\_loss\_by\_file=\{\}
675 
676     \textcolor{keywordflow}{for} s\_gp\_file\_name \textcolor{keywordflow}{in} ddf\_mean\_het\_by\_gp\_file\_by\_cycle:
677 
678         df\_mean\_het\_loss\_by\_cycle=convert\_mean\_hets\_to\_het\_loss( ddf\_mean\_het\_by\_gp\_file\_by\_cycle[ 
      s\_gp\_file\_name]  )
679         df\_mean\_het\_loss\_by\_generation=get\_per\_generation\_het\_from\_per\_cycle\_het( df\_mean\_het\_loss\_by\_cycle
      , 
680                                                                                         
      f\_cycles\_per\_generation )
681         df\_theoretical\_het\_loss\_by\_generation=
      \hyperlink{namespacenegui_1_1pgvalidationtests_ab5c519679dcc75c116bcbd7883107cfb}{get\_theoretical\_het\_loss\_per\_generation}( \(\backslash\)
682                                                             ddf\_ne\_by\_gp\_file\_by\_cycle[ s\_gp\_file\_name ], 
683                                                                                         
      f\_cycles\_per\_generation,
684                                                                                         f\_theoretical\_ne )
685     
686         \textcolor{comment}{#Add to the dicts that get returned:}
687         ddf\_expected\_het\_loss\_by\_file[ s\_gp\_file\_name ] = df\_mean\_het\_loss\_by\_generation
688 
689         ddf\_theoretical\_het\_loss\_by\_file[ s\_gp\_file\_name ] = df\_theoretical\_het\_loss\_by\_generation
690 
691         f\_ne0=f\_theoretical\_ne \textcolor{keywordflow}{if} f\_theoretical\_ne \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \(\backslash\)
692                 \textcolor{keywordflow}{else} np.mean( list(ddf\_ne\_by\_gp\_file\_by\_cycle[ s\_gp\_file\_name ].values()) ) 
693 
694         df\_theoretical\_as\_perc=\{ i\_gen: 100 * ( 1.0 - df\_theoretical\_het\_loss\_by\_generation[ i\_gen ] ) \(\backslash\)
695                                                                             \textcolor{keywordflow}{for} i\_gen \textcolor{keywordflow}{in} 
      df\_theoretical\_het\_loss\_by\_generation \} 
696         df\_expected\_as\_perc=\{ i\_gen: 100 * ( 1.0 - df\_mean\_het\_loss\_by\_generation[ i\_gen ] )  \(\backslash\)
697                                                             \textcolor{keywordflow}{for} i\_gen \textcolor{keywordflow}{in} df\_mean\_het\_loss\_by\_generation \}   
698 
699         df\_expected\_as\_perc\_sorted= \{ i\_key : df\_expected\_as\_perc[ i\_key ] \textcolor{keywordflow}{for} i\_key \textcolor{keywordflow}{in} sorted( 
      df\_expected\_as\_perc ) \}
700         df\_theoretical\_as\_perc\_sorted = \{ i\_key : df\_theoretical\_as\_perc[ i\_key ] \textcolor{keywordflow}{for} i\_key \textcolor{keywordflow}{in} sorted( 
      df\_theoretical\_as\_perc ) \}
701 
702         \textcolor{keywordflow}{if} b\_plot == \textcolor{keyword}{True} \textcolor{keywordflow}{and} b\_can\_plot == \textcolor{keyword}{True}:
703             
704             s\_title=\textcolor{stringliteral}{"Percent expected vs theoretical retained heterozygosity"} \(\backslash\)
705                 + \textcolor{stringliteral}{"\(\backslash\)nSim cycles: "} \(\backslash\)
706                 + str( i\_initial\_cycle\_number ) \(\backslash\)
707                 + \textcolor{stringliteral}{"-"} + str( i\_final\_cycle\_number ) + \textcolor{stringliteral}{"."} \(\backslash\)
708                 + \textcolor{stringliteral}{".  Ne for theoretical: "} + str( f\_ne0 ) \(\backslash\)
709                 + \textcolor{stringliteral}{"\(\backslash\)nCycles per generation: "} \(\backslash\)
710                 + str( int( round( f\_cycles\_per\_generation ) ) )
711 
712             s\_expected\_label=\textcolor{stringliteral}{"expected under HW, using allele frequencies"}
713             s\_theoretical\_label=\textcolor{stringliteral}{"theoretical: loss\_gen\_i =  1 - ( 1 - 1/2Ne )^i"}
714 
715             s\_xaxis\_label=\textcolor{stringliteral}{"generation"}
716             s\_yaxis\_label=\textcolor{stringliteral}{"percent heterozygosity retained"}
717                     
718             \hyperlink{namespacenegui_1_1pgvalidationtests_afbd41ca3bce1a778d97bd11efe270119}{plot\_two\_dicts\_similarly\_scaled}( df\_expected\_as\_perc\_sorted, 
719                             df\_theoretical\_as\_perc\_sorted, 
720                             s\_data1\_label=s\_expected\_label,
721                             s\_data2\_label=s\_theoretical\_label,
722                             s\_xaxis\_label=s\_xaxis\_label,
723                             s\_yaxis\_label=s\_yaxis\_label,
724                             s\_title=s\_title )
725 
726     \textcolor{comment}{#end for each genepop file named in the tsv file}
727 
728     \textcolor{keywordflow}{return} \{ \textcolor{stringliteral}{"expected\_het\_loss"} : ddf\_expected\_het\_loss\_by\_file, 
729                     \textcolor{stringliteral}{"theoretical\_het\_loss"} : ddf\_theoretical\_het\_loss\_by\_file \}
730 
731 \textcolor{comment}{#end get\_expected\_vs\_observed\_loss\_heterozygosity}
732 
\end{DoxyCode}
\index{negui\+::pgvalidationtests@{negui\+::pgvalidationtests}!get\+\_\+theoretical\+\_\+het\+\_\+loss\+\_\+per\+\_\+generation@{get\+\_\+theoretical\+\_\+het\+\_\+loss\+\_\+per\+\_\+generation}}
\index{get\+\_\+theoretical\+\_\+het\+\_\+loss\+\_\+per\+\_\+generation@{get\+\_\+theoretical\+\_\+het\+\_\+loss\+\_\+per\+\_\+generation}!negui\+::pgvalidationtests@{negui\+::pgvalidationtests}}
\subsubsection[{\texorpdfstring{get\+\_\+theoretical\+\_\+het\+\_\+loss\+\_\+per\+\_\+generation(df\+\_\+ne\+\_\+by\+\_\+cycle\+\_\+number, f\+\_\+cycles\+\_\+per\+\_\+generation, f\+\_\+theoretical\+\_\+ne=\+None)}{get_theoretical_het_loss_per_generation(df_ne_by_cycle_number, f_cycles_per_generation, f_theoretical_ne=None)}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgvalidationtests.\+get\+\_\+theoretical\+\_\+het\+\_\+loss\+\_\+per\+\_\+generation (
\begin{DoxyParamCaption}
\item[{}]{df\+\_\+ne\+\_\+by\+\_\+cycle\+\_\+number, }
\item[{}]{f\+\_\+cycles\+\_\+per\+\_\+generation, }
\item[{}]{f\+\_\+theoretical\+\_\+ne = {\ttfamily None}}
\end{DoxyParamCaption}
)}\hypertarget{namespacenegui_1_1pgvalidationtests_ab5c519679dcc75c116bcbd7883107cfb}{}\label{namespacenegui_1_1pgvalidationtests_ab5c519679dcc75c116bcbd7883107cfb}
\begin{DoxyVerb}This calculation for theoretical loss of heterozygosity is from
From http://labs.russell.wisc.edu/peery/files/2011/12/Primer-in-Population-Genetics.pdf

This def also returns the Ne value for the initial cycle.
\end{DoxyVerb}
 

Definition at line 221 of file pgvalidationtests.\+py.


\begin{DoxyCode}
221 \textcolor{keyword}{def }\hyperlink{namespacenegui_1_1pgvalidationtests_ab5c519679dcc75c116bcbd7883107cfb}{get\_theoretical\_het\_loss\_per\_generation}( df\_ne\_by\_cycle\_number, 
      f\_cycles\_per\_generation, f\_theoretical\_ne = None ):
222     \textcolor{stringliteral}{'''}
223 \textcolor{stringliteral}{}
224 \textcolor{stringliteral}{    This calculation for theoretical loss of heterozygosity is from}
225 \textcolor{stringliteral}{    From http://labs.russell.wisc.edu/peery/files/2011/12/Primer-in-Population-Genetics.pdf}
226 \textcolor{stringliteral}{}
227 \textcolor{stringliteral}{    This def also returns the Ne value for the initial cycle.}
228 \textcolor{stringliteral}{    '''}
229 
230     df\_theoretical\_het\_loss\_by\_generation=\{\}
231 
232     i\_cycles\_per\_generation=int( round( f\_cycles\_per\_generation ) )
233 
234     li\_sorted\_cycle\_numbers=list(df\_ne\_by\_cycle\_number.keys())
235     li\_sorted\_cycle\_numbers.sort()
236 
237     i\_min\_gen\_number=min( li\_sorted\_cycle\_numbers )
238 
239     f\_ne\_for\_initial\_pop=f\_theoretical\_ne \textcolor{keywordflow}{if} f\_theoretical\_ne \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \(\backslash\)
240             \textcolor{keywordflow}{else} np.mean( list( df\_ne\_by\_cycle\_number.values() ) )  
241 
242     f\_one\_over\_2Ne=old\_div(1.0,( 2.0*f\_ne\_for\_initial\_pop ))
243 
244     f\_one\_minus\_one\_over\_2Ne=1 - f\_one\_over\_2Ne
245 
246     \textcolor{stringliteral}{'''}
247 \textcolor{stringliteral}{    We want zero loss of het in the}
248 \textcolor{stringliteral}{    first cycle, so the counter,}
249 \textcolor{stringliteral}{    which gives the exponent in the }
250 \textcolor{stringliteral}{    loss calculation, will be at zero}
251 \textcolor{stringliteral}{    for the first (initial) cycle. }
252 \textcolor{stringliteral}{    '''}
253     i\_generation\_count = -1
254 
255     i\_generation\_number=0
256 
257     \textcolor{keywordflow}{for} i\_gen \textcolor{keywordflow}{in} range( 0, len( li\_sorted\_cycle\_numbers ), i\_cycles\_per\_generation ):
258 
259         i\_generation\_count += 1
260         i\_generation\_number+=1
261 
262         \textcolor{stringliteral}{'''}
263 \textcolor{stringliteral}{        We raise ( 1 - 1/2Ne ) to  t = gen\_counter, subtract}
264 \textcolor{stringliteral}{        that value from 1:}
265 \textcolor{stringliteral}{        '''}
266         f\_loss\_this\_gen=1 - (  ( f\_one\_minus\_one\_over\_2Ne )**i\_generation\_count  )
267 
268         df\_theoretical\_het\_loss\_by\_generation[ i\_generation\_number ] = f\_loss\_this\_gen
269     \textcolor{comment}{#end for each cycle}
270     
271     \textcolor{keywordflow}{return}  df\_theoretical\_het\_loss\_by\_generation
272 
273 \textcolor{comment}{#end get\_theoretical\_het\_loss\_per\_generation}
274 
\end{DoxyCode}
\index{negui\+::pgvalidationtests@{negui\+::pgvalidationtests}!has\+\_\+requested\+\_\+cycle\+\_\+range@{has\+\_\+requested\+\_\+cycle\+\_\+range}}
\index{has\+\_\+requested\+\_\+cycle\+\_\+range@{has\+\_\+requested\+\_\+cycle\+\_\+range}!negui\+::pgvalidationtests@{negui\+::pgvalidationtests}}
\subsubsection[{\texorpdfstring{has\+\_\+requested\+\_\+cycle\+\_\+range(o\+\_\+tsv\+\_\+file, i\+\_\+initial\+\_\+cycle\+\_\+number, i\+\_\+final\+\_\+cycle\+\_\+number)}{has_requested_cycle_range(o_tsv_file, i_initial_cycle_number, i_final_cycle_number)}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgvalidationtests.\+has\+\_\+requested\+\_\+cycle\+\_\+range (
\begin{DoxyParamCaption}
\item[{}]{o\+\_\+tsv\+\_\+file, }
\item[{}]{i\+\_\+initial\+\_\+cycle\+\_\+number, }
\item[{}]{i\+\_\+final\+\_\+cycle\+\_\+number}
\end{DoxyParamCaption}
)}\hypertarget{namespacenegui_1_1pgvalidationtests_acebbfd32727989f141b02f26e736b41c}{}\label{namespacenegui_1_1pgvalidationtests_acebbfd32727989f141b02f26e736b41c}
\begin{DoxyVerb}This is not yet implemented, so returns True in all cases.
\end{DoxyVerb}
 

Definition at line 383 of file pgvalidationtests.\+py.


\begin{DoxyCode}
383 \textcolor{keyword}{def }\hyperlink{namespacenegui_1_1pgvalidationtests_acebbfd32727989f141b02f26e736b41c}{has\_requested\_cycle\_range}( o\_tsv\_file, i\_initial\_cycle\_number, 
      i\_final\_cycle\_number ):
384     \textcolor{stringliteral}{'''}
385 \textcolor{stringliteral}{    This is not yet implemented, so returns True in all cases.}
386 \textcolor{stringliteral}{    '''}
387     b\_has\_range=\textcolor{keyword}{True}
388     \textcolor{keywordflow}{return} b\_has\_range
389 \textcolor{comment}{#end has\_requested\_cycle\_range}
390 
\end{DoxyCode}
\index{negui\+::pgvalidationtests@{negui\+::pgvalidationtests}!plot\+\_\+two\+\_\+dicts\+\_\+similarly\+\_\+scaled@{plot\+\_\+two\+\_\+dicts\+\_\+similarly\+\_\+scaled}}
\index{plot\+\_\+two\+\_\+dicts\+\_\+similarly\+\_\+scaled@{plot\+\_\+two\+\_\+dicts\+\_\+similarly\+\_\+scaled}!negui\+::pgvalidationtests@{negui\+::pgvalidationtests}}
\subsubsection[{\texorpdfstring{plot\+\_\+two\+\_\+dicts\+\_\+similarly\+\_\+scaled(d\+\_\+dict1, d\+\_\+dict2, s\+\_\+data1\+\_\+label="""", s\+\_\+data2\+\_\+label="""", s\+\_\+xaxis\+\_\+label="""", s\+\_\+yaxis\+\_\+label="""", s\+\_\+title="""", s\+\_\+plot\+\_\+file\+\_\+name=\+None)}{plot_two_dicts_similarly_scaled(d_dict1, d_dict2, s_data1_label="", s_data2_label="", s_xaxis_label="", s_yaxis_label="", s_title="", s_plot_file_name=None)}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgvalidationtests.\+plot\+\_\+two\+\_\+dicts\+\_\+similarly\+\_\+scaled (
\begin{DoxyParamCaption}
\item[{}]{d\+\_\+dict1, }
\item[{}]{d\+\_\+dict2, }
\item[{}]{s\+\_\+data1\+\_\+label = {\ttfamily \char`\"{}\char`\"{}}, }
\item[{}]{s\+\_\+data2\+\_\+label = {\ttfamily \char`\"{}\char`\"{}}, }
\item[{}]{s\+\_\+xaxis\+\_\+label = {\ttfamily \char`\"{}\char`\"{}}, }
\item[{}]{s\+\_\+yaxis\+\_\+label = {\ttfamily \char`\"{}\char`\"{}}, }
\item[{}]{s\+\_\+title = {\ttfamily \char`\"{}\char`\"{}}, }
\item[{}]{s\+\_\+plot\+\_\+file\+\_\+name = {\ttfamily None}}
\end{DoxyParamCaption}
)}\hypertarget{namespacenegui_1_1pgvalidationtests_afbd41ca3bce1a778d97bd11efe270119}{}\label{namespacenegui_1_1pgvalidationtests_afbd41ca3bce1a778d97bd11efe270119}
\begin{DoxyVerb}This def assumes 
    --that the dict1 and dict2 keys have the x-axis values,
    and that they are numerical.
    --that the axis scales for dict1 and dict2 are similar for keys(),
    and similar for values().
\end{DoxyVerb}
 

Definition at line 302 of file pgvalidationtests.\+py.


\begin{DoxyCode}
302                                             s\_plot\_file\_name=\textcolor{keywordtype}{None} ):
303 
304     \textcolor{stringliteral}{'''}
305 \textcolor{stringliteral}{    This def assumes }
306 \textcolor{stringliteral}{        --that the dict1 and dict2 keys have the x-axis values,}
307 \textcolor{stringliteral}{        and that they are numerical.}
308 \textcolor{stringliteral}{        --that the axis scales for dict1 and dict2 are similar for keys(),}
309 \textcolor{stringliteral}{        and similar for values().}
310 \textcolor{stringliteral}{    '''}
311 
312     PLOTLINEWIDTH=2.0
313     FONTSIZE=12
314     PLOTFONTSIZE=12
315     LINEPOINTTYPE1=\textcolor{stringliteral}{"o-"}
316     LINEPOINTTYPE2=\textcolor{stringliteral}{"^-"}
317 
318     MAX\_TOT\_VALS\_FOR\_POINTS=65
319 
320     \textcolor{keywordflow}{if} len( d\_dict1 ) > MAX\_TOT\_VALS\_FOR\_POINTS:
321         LINEPOINTTYPE1=\textcolor{stringliteral}{"-"}
322         LINEPOINTTYPE2=\textcolor{stringliteral}{"-"}
323     \textcolor{comment}{#end if too many gens to show points, just show line}
324 
325     f\_y\_limits\_units=(old\_div(1,10.0))
326     f\_x\_limits\_units=(old\_div(1,60.0) )
327 
328     f\_label\_y\_space\_unit=(old\_div(1,30.0))
329     f\_label\_x\_space\_unit=(old\_div(1,5.0))
330 
331     v\_min\_x\_value\_dict1=min( list( d\_dict1.keys() ) )
332     v\_max\_x\_value\_dict1=max( list( d\_dict1.keys() ) )
333 
334     v\_min\_y\_value\_dict1=min( list( d\_dict1.values() ) )
335     v\_max\_y\_value\_dict1=max( list( d\_dict1.values() ) )
336 
337     v\_min\_x\_value\_dict2=min( list( d\_dict2.keys() ) )
338     v\_max\_x\_value\_dict2=max( list( d\_dict2.keys() ) )
339 
340     v\_min\_y\_value\_dict2=min( list( d\_dict2.values() ) )
341     v\_max\_y\_value\_dict2=max( list( d\_dict2.values() ) )
342 
343     v\_min\_x\_value=min( v\_min\_x\_value\_dict1, v\_min\_x\_value\_dict2 )
344     v\_max\_x\_value=max( v\_max\_x\_value\_dict1, v\_max\_x\_value\_dict2 )
345 
346     v\_min\_y\_value=min( v\_min\_y\_value\_dict1, v\_min\_y\_value\_dict2 )
347     v\_max\_y\_value=max( v\_max\_y\_value\_dict1, v\_max\_y\_value\_dict2 )
348 
349     v\_rightmnost\_dict1\_yval=d\_dict1[ v\_max\_x\_value\_dict1 ] 
350     v\_rightmnost\_dict2\_yval=d\_dict2[ v\_max\_x\_value\_dict2 ]
351 
352     v\_y\_range=v\_max\_y\_value-v\_min\_y\_value
353     v\_x\_range=v\_max\_x\_value-v\_min\_x\_value
354 
355     lf\_xlimits=[ v\_min\_x\_value - v\_x\_range* f\_x\_limits\_units, v\_max\_x\_value + v\_x\_range*f\_x\_limits\_units ]
356 
357     lf\_ylimits=[ v\_min\_y\_value - v\_y\_range*f\_y\_limits\_units, v\_max\_y\_value + v\_y\_range*f\_y\_limits\_units ]
358 
359     f\_label\_x\_coord\_offset=( lf\_xlimits[ 1 ] - lf\_xlimits[ 0 ] ) * f\_label\_x\_space\_unit
360     f\_label\_y\_coord\_offset=( lf\_ylimits[ 1 ] - lf\_ylimits[ 0 ] ) * f\_label\_y\_space\_unit
361                 
362     o\_fig=pt.figure()
363     o\_subplt=o\_fig.add\_subplot(111)
364     o\_subplt.plot( list(d\_dict1.keys()), list( d\_dict1.values() ), LINEPOINTTYPE1, linewidth=PLOTLINEWIDTH 
      )
365     o\_subplt.plot( list(d\_dict2.keys()), list( d\_dict2.values() ), LINEPOINTTYPE2, linewidth=PLOTLINEWIDTH 
      )
366 
367     o\_subplt.set\_ybound( lower=lf\_ylimits[0], upper=lf\_ylimits[ 1 ] )
368     o\_subplt.set\_xlabel( s\_xaxis\_label, fontsize=FONTSIZE )
369     o\_subplt.set\_ylabel( s\_yaxis\_label, fontsize=FONTSIZE )
370     o\_subplt.set\_title( s\_title, fontsize=FONTSIZE )
371     o\_subplt.legend( [ s\_data1\_label , s\_data2\_label ], frameon=\textcolor{keyword}{False}, fontsize=PLOTFONTSIZE )
372 
373     pt.show()
374 
375     o\_fig=\textcolor{keywordtype}{None}
376 
377     \textcolor{keywordflow}{if} s\_plot\_file\_name \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
378         pt.savefigure( s\_file\_name )
379     \textcolor{comment}{#end if no plot file}
380     \textcolor{keywordflow}{return}
381 \textcolor{comment}{#end plot\_two\_dicts\_similarly\_scaled}
382 
\end{DoxyCode}


\subsection{Variable Documentation}
\index{negui\+::pgvalidationtests@{negui\+::pgvalidationtests}!ddefs\+\_\+by\+\_\+test\+\_\+name@{ddefs\+\_\+by\+\_\+test\+\_\+name}}
\index{ddefs\+\_\+by\+\_\+test\+\_\+name@{ddefs\+\_\+by\+\_\+test\+\_\+name}!negui\+::pgvalidationtests@{negui\+::pgvalidationtests}}
\subsubsection[{\texorpdfstring{ddefs\+\_\+by\+\_\+test\+\_\+name}{ddefs_by_test_name}}]{\setlength{\rightskip}{0pt plus 5cm}dictionary negui.\+pgvalidationtests.\+ddefs\+\_\+by\+\_\+test\+\_\+name}\hypertarget{namespacenegui_1_1pgvalidationtests_ae3331aa28e38492caa2fdc9b420889a7}{}\label{namespacenegui_1_1pgvalidationtests_ae3331aa28e38492caa2fdc9b420889a7}
{\bfseries Initial value\+:}
\begin{DoxyCode}
1 = \{ \textcolor{stringliteral}{"hetloss"} : get\_expected\_vs\_observed\_loss\_heterozygosity, 
2                                     \textcolor{stringliteral}{"het"}:get\_expected\_vs\_observed\_heterozygosity \}
\end{DoxyCode}


Definition at line 761 of file pgvalidationtests.\+py.

\index{negui\+::pgvalidationtests@{negui\+::pgvalidationtests}!L\+S\+\_\+\+A\+R\+G\+S\+\_\+\+H\+E\+LP@{L\+S\+\_\+\+A\+R\+G\+S\+\_\+\+H\+E\+LP}}
\index{L\+S\+\_\+\+A\+R\+G\+S\+\_\+\+H\+E\+LP@{L\+S\+\_\+\+A\+R\+G\+S\+\_\+\+H\+E\+LP}!negui\+::pgvalidationtests@{negui\+::pgvalidationtests}}
\subsubsection[{\texorpdfstring{L\+S\+\_\+\+A\+R\+G\+S\+\_\+\+H\+E\+LP}{LS_ARGS_HELP}}]{\setlength{\rightskip}{0pt plus 5cm}list negui.\+pgvalidationtests.\+L\+S\+\_\+\+A\+R\+G\+S\+\_\+\+H\+E\+LP}\hypertarget{namespacenegui_1_1pgvalidationtests_a219d6900553eeb3e1f1a11286170cced}{}\label{namespacenegui_1_1pgvalidationtests_a219d6900553eeb3e1f1a11286170cced}
{\bfseries Initial value\+:}
\begin{DoxyCode}
1 = [ \textcolor{stringliteral}{"names tsv file of ne estimations as generated "} \(\backslash\)
2                         + \textcolor{stringliteral}{"from negui interface or console command using pgdriveneestimator.py"},
3                         \textcolor{stringliteral}{"Integer The ith cycle (pop section in the source genepop file.  This "} \(\backslash\)
4                         +   \textcolor{stringliteral}{"number will be the initial pop used to get Ne for "} \(\backslash\)
5                         +\textcolor{stringliteral}{"the expected het loss calculation)."},
6                         \textcolor{stringliteral}{"Integer, the jth cycle, to be the last cycle analyzed."}, 
7                         \textcolor{stringliteral}{"Numeric (int or float) breeding cycles per cycle"},
8                         \textcolor{stringliteral}{"Integer i giving the min value for a range of loci (as ordered in "} \(\backslash\)
9                         + \textcolor{stringliteral}{"the genepop file), the ith to the jth"}, 
10                         \textcolor{stringliteral}{"Integer j giving the max value for a range of loci, the ith to the jth"},
11                         \textcolor{stringliteral}{"String, [ 'hetloss' | 'het'  ], to compare expected vs observed loss of "} \(\backslash\)
12                         + \textcolor{stringliteral}{"heterozygosity, or expected vs observed heterozygosity"} ]
\end{DoxyCode}


Definition at line 739 of file pgvalidationtests.\+py.

\index{negui\+::pgvalidationtests@{negui\+::pgvalidationtests}!L\+S\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+A\+R\+G\+S\+\_\+\+H\+E\+LP@{L\+S\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+A\+R\+G\+S\+\_\+\+H\+E\+LP}}
\index{L\+S\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+A\+R\+G\+S\+\_\+\+H\+E\+LP@{L\+S\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+A\+R\+G\+S\+\_\+\+H\+E\+LP}!negui\+::pgvalidationtests@{negui\+::pgvalidationtests}}
\subsubsection[{\texorpdfstring{L\+S\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+A\+R\+G\+S\+\_\+\+H\+E\+LP}{LS_OPTIONAL_ARGS_HELP}}]{\setlength{\rightskip}{0pt plus 5cm}list negui.\+pgvalidationtests.\+L\+S\+\_\+\+O\+P\+T\+I\+O\+N\+A\+L\+\_\+\+A\+R\+G\+S\+\_\+\+H\+E\+LP}\hypertarget{namespacenegui_1_1pgvalidationtests_a9514244efc3e661ac3ca4356f14fdfa9}{}\label{namespacenegui_1_1pgvalidationtests_a9514244efc3e661ac3ca4356f14fdfa9}
{\bfseries Initial value\+:}
\begin{DoxyCode}
1 = [ \textcolor{stringliteral}{"float, Ne value to use for the calculation of the expected heterozygosity "} \(\backslash\)
2                                 + \textcolor{stringliteral}{"( 1-( 1-1/(2Ne) )^\{repro\_cycle\_number\}), and loss of heterozygosity, "} \(\backslash\)
3                                 + \textcolor{stringliteral}{"( Hz\_repro\_cycle\_i=Hz\_repro\_cycle\_i-1 * ( 1 - 1/( 2Ne ) ) ).  "} \(\backslash\)
4                                 + \textcolor{stringliteral}{"Default is the mean of the LDNe estimations"} ]
\end{DoxyCode}


Definition at line 754 of file pgvalidationtests.\+py.

