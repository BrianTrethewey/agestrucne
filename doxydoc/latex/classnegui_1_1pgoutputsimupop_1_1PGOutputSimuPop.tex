\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop}{}\section{negui.\+pgoutputsimupop.\+P\+G\+Output\+Simu\+Pop Class Reference}
\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop}\index{negui.\+pgoutputsimupop.\+P\+G\+Output\+Simu\+Pop@{negui.\+pgoutputsimupop.\+P\+G\+Output\+Simu\+Pop}}
Inheritance diagram for negui.\+pgoutputsimupop.\+P\+G\+Output\+Simu\+Pop\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def {\bfseries \+\_\+\+\_\+init\+\_\+\+\_\+} (self, s\+\_\+output\+\_\+files\+\_\+prefix)\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a8f42fc0afc9024177960bb6287e45493}{}\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a8f42fc0afc9024177960bb6287e45493}

\item 
def {\bfseries open\+Out} (self)\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a7cea46f9212d05e98ce14b7647781590}{}\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a7cea46f9212d05e98ce14b7647781590}

\item 
def {\bfseries open\+Err} (self)\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_ae3f0c28a1a9afbef82fddd8d26d3ea3b}{}\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_ae3f0c28a1a9afbef82fddd8d26d3ea3b}

\item 
def {\bfseries open\+Mega\+DB} (self)\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_afac367cb22b4498a2c5170173de1bdc1}{}\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_afac367cb22b4498a2c5170173de1bdc1}

\item 
def {\bfseries copy\+Me} (self)\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a5ab021b0ff9d452891a52313b9402fbf}{}\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a5ab021b0ff9d452891a52313b9402fbf}

\item 
def {\bfseries open\+Conf} (self)\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_abd8a699e5a3adf2b746bdb778602fe60}{}\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_abd8a699e5a3adf2b746bdb778602fe60}

\item 
def \hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a19aedb58718296302655581be640f995}{bz2\+Compress\+All\+Files} (self)
\item 
def \hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_af093f63ef577cb9d9778920ec6589516}{gen2\+Genepop} (self, idx\+\_\+allele\+\_\+start, idx\+\_\+allele\+\_\+stop, b\+\_\+do\+\_\+compress=True, b\+\_\+pop\+\_\+per\+\_\+gen=False)
\item 
def {\bfseries basename} (self)\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_af67ba734fbe5d4240a8cef38e63586d1}{}\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_af67ba734fbe5d4240a8cef38e63586d1}

\item 
def {\bfseries basename} (self, s\+\_\+basename)\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_aafca25668d51a1beec732306b7973884}{}\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_aafca25668d51a1beec732306b7973884}

\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
{\bfseries out}\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a4198008f7f7f029a29f8441ea7619170}{}\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a4198008f7f7f029a29f8441ea7619170}

\item 
{\bfseries err}\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a5eeccbf099cd8be3e8ab5906565d7b79}{}\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a5eeccbf099cd8be3e8ab5906565d7b79}

\item 
{\bfseries mega\+DB}\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a76379971c8aa1a3b175f171821b0b8f1}{}\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a76379971c8aa1a3b175f171821b0b8f1}

\item 
{\bfseries conf}\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_ac6e385cca72ff0073251b511eea1103f}{}\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_ac6e385cca72ff0073251b511eea1103f}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Object meant to fetch parameter values and prepare them for 
use in a simuPop simulation.  

Object to be passed to a PGOpSimuPop object, which is, in turn,
passed to a PGGuiSimuPop object, so that the widgets can then access
defs in this input object, in order to, for example, show or allow
changes in parameter values for users before they run the simulation.
\end{DoxyVerb}
 

Definition at line 22 of file pgoutputsimupop.\+py.



\subsection{Member Function Documentation}
\index{negui\+::pgoutputsimupop\+::\+P\+G\+Output\+Simu\+Pop@{negui\+::pgoutputsimupop\+::\+P\+G\+Output\+Simu\+Pop}!bz2\+Compress\+All\+Files@{bz2\+Compress\+All\+Files}}
\index{bz2\+Compress\+All\+Files@{bz2\+Compress\+All\+Files}!negui\+::pgoutputsimupop\+::\+P\+G\+Output\+Simu\+Pop@{negui\+::pgoutputsimupop\+::\+P\+G\+Output\+Simu\+Pop}}
\subsubsection[{\texorpdfstring{bz2\+Compress\+All\+Files(self)}{bz2CompressAllFiles(self)}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgoutputsimupop.\+P\+G\+Output\+Simu\+Pop.\+bz2\+Compress\+All\+Files (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a19aedb58718296302655581be640f995}{}\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a19aedb58718296302655581be640f995}
\begin{DoxyVerb}used code and advice in, 
http://stackoverflow.com/questions/9518705/big-file-compression-with-python

Note: checked the shutil documentation at https://docs.python.org/2/library/shutil.html
which warns of loss of meta file info (owner/group ACLs) when using shutil.copy() or shutil.copy2().  Unclear
whether this applies to the copyfileobj, though my few tests showd all of these were retained.
\end{DoxyVerb}
 

Definition at line 152 of file pgoutputsimupop.\+py.


\begin{DoxyCode}
152     \textcolor{keyword}{def }\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a19aedb58718296302655581be640f995}{bz2CompressAllFiles}(self):
153         \textcolor{stringliteral}{'''}
154 \textcolor{stringliteral}{        used code and advice in, }
155 \textcolor{stringliteral}{        http://stackoverflow.com/questions/9518705/big-file-compression-with-python}
156 \textcolor{stringliteral}{}
157 \textcolor{stringliteral}{        Note: checked the shutil documentation at https://docs.python.org/2/library/shutil.html}
158 \textcolor{stringliteral}{        which warns of loss of meta file info (owner/group ACLs) when using shutil.copy() or
       shutil.copy2().  Unclear}
159 \textcolor{stringliteral}{        whether this applies to the copyfileobj, though my few tests showd all of these were retained.}
160 \textcolor{stringliteral}{        '''}
161         \textcolor{keywordflow}{for} s\_myfile \textcolor{keywordflow}{in} [ self.\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a50f64be6bb990a0ac6898a44b4bf6fbc}{\_\_outname}, self.\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a26363a7bbc4ae53b86585e32f0360e2a}{\_\_errname}, self.
      \hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_aa89de70104807ce7e26bb17310f74b97}{\_\_megadbname}, self.\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_af5c9a72247505d2c2bb3d7400cbc09b3}{\_\_confname} ]:
162             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a1fdfb988619bd4a9d377a1e20f52839c}{\_\_file\_exists}( s\_myfile ):
163                 self.\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_abf6aab4f7982c2b0f9e4544343bf241b}{\_\_raise\_file\_not\_found\_error}( s\_myfile, \textcolor{stringliteral}{"compress file
       with bz2"}  )
164             \textcolor{keywordflow}{else}:
165                 with open( s\_myfile, \textcolor{stringliteral}{'rb'} ) \textcolor{keyword}{as} o\_input:
166                     with bz2.BZ2File( s\_myfile + \textcolor{stringliteral}{'.bz2'}, \textcolor{stringliteral}{'wb'}, compresslevel=9 ) \textcolor{keyword}{as} o\_output:
167                         \textcolor{comment}{#try/except overkill, but want logic to show}
168                         \textcolor{comment}{#we don't remove the input file}
169                         \textcolor{comment}{#if the copy op fails:}
170                         \textcolor{keywordflow}{try}: 
171                             shutil.copyfileobj( o\_input, o\_output )
172                         \textcolor{keywordflow}{except} Exception,  e:
173                             \textcolor{keywordflow}{raise} e
174                         \textcolor{comment}{#end try except}
175                         os.remove( s\_myfile )   
176                     \textcolor{comment}{#end with bzfile for writing}
177                 \textcolor{comment}{#end with current file for reading}
178             \textcolor{comment}{#end if file absent, else exists}
179         \textcolor{comment}{#end for each file}
\end{DoxyCode}
\index{negui\+::pgoutputsimupop\+::\+P\+G\+Output\+Simu\+Pop@{negui\+::pgoutputsimupop\+::\+P\+G\+Output\+Simu\+Pop}!gen2\+Genepop@{gen2\+Genepop}}
\index{gen2\+Genepop@{gen2\+Genepop}!negui\+::pgoutputsimupop\+::\+P\+G\+Output\+Simu\+Pop@{negui\+::pgoutputsimupop\+::\+P\+G\+Output\+Simu\+Pop}}
\subsubsection[{\texorpdfstring{gen2\+Genepop(self, idx\+\_\+allele\+\_\+start, idx\+\_\+allele\+\_\+stop, b\+\_\+do\+\_\+compress=\+True, b\+\_\+pop\+\_\+per\+\_\+gen=\+False)}{gen2Genepop(self, idx_allele_start, idx_allele_stop, b_do_compress=True, b_pop_per_gen=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def negui.\+pgoutputsimupop.\+P\+G\+Output\+Simu\+Pop.\+gen2\+Genepop (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{idx\+\_\+allele\+\_\+start, }
\item[{}]{idx\+\_\+allele\+\_\+stop, }
\item[{}]{b\+\_\+do\+\_\+compress = {\ttfamily True}, }
\item[{}]{b\+\_\+pop\+\_\+per\+\_\+gen = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_af093f63ef577cb9d9778920ec6589516}{}\label{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_af093f63ef577cb9d9778920ec6589516}
\begin{DoxyVerb}reads the *.gen file from the simuPop output
and produces a genepop file based on the gen file

param idx_allele_start: int, one-based index giving the
item (loci) number of the first allele entry in the line of gen-file input
Example, if the *gen file has 10 microsates and 40 SNPs, then its first
10 allele entries (that follow the indiv number and the gneration number)
will be the microsats, and the final 40 allele entries will be the SNPs
If we wanted only the Microsats to be included in the gen file, then
this param would be "1", and the idx_allele_stop value would be 10. 
If we want both msats and snps, we'd give 1 and 50 for these params. 
If we want only SNPs, wed enter 11 for start allele and 50 for stop.

param idx_allele_stop: int, one-based index giving the
item (loci) number of the last allele entry in the line of gen-file input

param optional b_do_compress, if true, will bzip2 the output genepop file

param optional b_pop_per_gen, if true, will insert a "Pop" line between the
generations, as given by the 2nd field in the gen file
\end{DoxyVerb}
 

Definition at line 185 of file pgoutputsimupop.\+py.


\begin{DoxyCode}
185             b\_pop\_per\_gen=\textcolor{keyword}{False} ):
186 
187         \textcolor{stringliteral}{'''}
188 \textcolor{stringliteral}{        reads the *.gen file from the simuPop output}
189 \textcolor{stringliteral}{        and produces a genepop file based on the gen file}
190 \textcolor{stringliteral}{}
191 \textcolor{stringliteral}{        param idx\_allele\_start: int, one-based index giving the}
192 \textcolor{stringliteral}{        item (loci) number of the first allele entry in the line of gen-file input}
193 \textcolor{stringliteral}{        Example, if the *gen file has 10 microsates and 40 SNPs, then its first}
194 \textcolor{stringliteral}{        10 allele entries (that follow the indiv number and the gneration number)}
195 \textcolor{stringliteral}{        will be the microsats, and the final 40 allele entries will be the SNPs}
196 \textcolor{stringliteral}{        If we wanted only the Microsats to be included in the gen file, then}
197 \textcolor{stringliteral}{        this param would be "1", and the idx\_allele\_stop value would be 10. }
198 \textcolor{stringliteral}{        If we want both msats and snps, we'd give 1 and 50 for these params. }
199 \textcolor{stringliteral}{        If we want only SNPs, wed enter 11 for start allele and 50 for stop.}
200 \textcolor{stringliteral}{}
201 \textcolor{stringliteral}{        param idx\_allele\_stop: int, one-based index giving the}
202 \textcolor{stringliteral}{        item (loci) number of the last allele entry in the line of gen-file input}
203 \textcolor{stringliteral}{}
204 \textcolor{stringliteral}{        param optional b\_do\_compress, if true, will bzip2 the output genepop file}
205 \textcolor{stringliteral}{}
206 \textcolor{stringliteral}{        param optional b\_pop\_per\_gen, if true, will insert a "Pop" line between the}
207 \textcolor{stringliteral}{        generations, as given by the 2nd field in the gen file}
208 \textcolor{stringliteral}{        '''}
209 
210         o\_genfile=\textcolor{keywordtype}{None}
211         o\_genepopfile=\textcolor{keywordtype}{None}
212         s\_genepop\_filename=self.\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a30fb6b94af13efad6becfbe6fddc1d95}{\_\_genfile} + \textcolor{stringliteral}{"."} + GENEPOP\_FILE\_EXTENSION 
213         i\_num\_loci=(idx\_allele\_stop-idx\_allele\_start) + 1
214 
215         IDX\_GEN\_INDIV=0
216         IDX\_GEN\_GENERATION=1
217         IDX\_FIRST\_ALLELE=2
218 
219         i\_genepop\_already\_exists=self.\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a1fdfb988619bd4a9d377a1e20f52839c}{\_\_file\_exists}( s\_genepop\_filename )
220 
221         \textcolor{keywordflow}{if} i\_genepop\_already\_exists != FILE\_DOES\_NOT\_EXIST:
222 
223             self.\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_ad3f4c271b5b800d0137460e2349452e0}{\_\_raise\_file\_exists\_error}( s\_genepop\_filename, 
224                     \textcolor{stringliteral}{"create genepop file from gen file"} )
225         \textcolor{comment}{#end if genepop file already exists}
226 
227         i\_genfile\_exists=self.\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a1fdfb988619bd4a9d377a1e20f52839c}{\_\_file\_exists}( self.\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a30fb6b94af13efad6becfbe6fddc1d95}{\_\_genfile} )
228         
229         \textcolor{comment}{#if we have the uncompressed version available}
230         \textcolor{comment}{#we use it:}
231         \textcolor{keywordflow}{if} i\_genfile\_exists == FILE\_EXISTS\_UNCOMPRESSED \(\backslash\)
232             \textcolor{keywordflow}{or} i\_genfile\_exists == FILE\_EXISTS\_AS\_BOTH\_UNCOMPRESSED\_AND\_BZ2:
233 
234             o\_genfile=open( self.\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a30fb6b94af13efad6becfbe6fddc1d95}{\_\_genfile} )
235 
236         \textcolor{keywordflow}{elif} i\_genfile\_exists == FILE\_EXISTS\_AS\_BZ2:
237 
238             o\_genfile=bz2.BZ2File( self.\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a30fb6b94af13efad6becfbe6fddc1d95}{\_\_genfile} + \textcolor{stringliteral}{".bz2"} )
239 
240         \textcolor{keywordflow}{else}:
241             self.\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_abf6aab4f7982c2b0f9e4544343bf241b}{\_\_raise\_file\_not\_found\_error}( self.
      \hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a30fb6b94af13efad6becfbe6fddc1d95}{\_\_genfile}, \textcolor{stringliteral}{"convert gen file to genepop"} )
242         \textcolor{comment}{#end if uncompressed only or uncomp. and compressed, else compressed only, else no file}
243         
244         \textcolor{keywordflow}{if} b\_do\_compress == \textcolor{keyword}{True}:
245             o\_genepopfile=bz2.BZ2File( s\_genepop\_filename + \textcolor{stringliteral}{'.bz2'}, \textcolor{stringliteral}{'wb'}, compresslevel=9 ) 
246         \textcolor{keywordflow}{else}:
247             o\_genepopfile=open( s\_genepop\_filename, \textcolor{stringliteral}{'w'} )
248         \textcolor{comment}{#end if compress else don't}
249 
250         \textcolor{comment}{#write header and loci list:}
251 
252         o\_genepopfile.write( \textcolor{stringliteral}{"genepop from simupop run data file "} \(\backslash\)
253                 + self.\hyperlink{classnegui_1_1pgoutputsimupop_1_1PGOutputSimuPop_a30fb6b94af13efad6becfbe6fddc1d95}{\_\_genfile} + \textcolor{stringliteral}{"\(\backslash\)n"} )
254 
255         \textcolor{keywordflow}{for} i\_locus \textcolor{keywordflow}{in} range( i\_num\_loci ):
256             o\_genepopfile.write(\textcolor{stringliteral}{"l"} + str(i\_locus) + \textcolor{stringliteral}{"\(\backslash\)n"} )
257         \textcolor{comment}{#end for each loci number}
258 
259         \textcolor{comment}{#write indiv id and alleles, line by line:}
260         i\_currgen=\textcolor{keywordtype}{None}
261 
262         \textcolor{keywordflow}{for} s\_line \textcolor{keywordflow}{in} o\_genfile:
263             
264             ls\_line = s\_line.rstrip().split(\textcolor{stringliteral}{" "})
265 
266             i\_id = int(float(ls\_line[IDX\_GEN\_INDIV]))
267             i\_gen = int(float(ls\_line[IDX\_GEN\_GENERATION]))
268             idx\_first\_allele\_in\_line=( idx\_allele\_start + IDX\_FIRST\_ALLELE ) - 1
269             idx\_last\_allele\_in\_line=( idx\_allele\_stop  + IDX\_FIRST\_ALLELE ) - 1 
270             ls\_alleles = ls\_line[ idx\_first\_allele\_in\_line : idx\_last\_allele\_in\_line + 1 ]
271 
272             \textcolor{keywordflow}{if} i\_currgen \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{or} ( b\_pop\_per\_gen == \textcolor{keyword}{True} \textcolor{keywordflow}{and} i\_currgen != i\_gen ):
273                     o\_genepopfile.write( \textcolor{stringliteral}{"pop\(\backslash\)n"} )
274                     i\_currgen=i\_gen
275                 \textcolor{comment}{#end if new generation (== new population )}
276                 \textcolor{comment}{#end if we should make a new population for each generation}
277 
278             o\_genepopfile.write( str( i\_id ) + \textcolor{stringliteral}{","} +  \textcolor{stringliteral}{" "}.join( ls\_alleles ) + \textcolor{stringliteral}{"\(\backslash\)n"}  )
279 
280         \textcolor{comment}{#end for each line in gen file}
281 
282         o\_genfile.close()
283         o\_genepopfile.close()
284 
285         \textcolor{keywordflow}{return}
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
pgoutputsimupop.\+py\end{DoxyCompactItemize}
